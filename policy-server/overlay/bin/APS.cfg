#######################################################################
## APS.cfg - This is the APS configuration file. 
##
## This file controls all of the behavior of APS, FPS and the required 
## formation of passwords during the password change function.
##
## This file is organized into sections. Other than the first section
## (which starts immediately after this block comment), each section
## starts with a keyword surrounded by square brackets. You can jump
## right to a section by searching for the section name in brackets.
##
## The section names are:
##
##      (first section)     This section contains general settings
##                          and is untitled. It begins immediately
##                          after this (huge) block of comments.
##      [Mail]              Defines Mail Server stuff
##      [Logging]           Defines custom logging options
##      [Custom]            Defines custom extension options
##      [Dictionary]        Lists disallowed embedded words
##      [Complexity]        Defines metrics for password complexity
##      [Mappings]          Maps logical to physical attributes
##      [APSAdmin]          Help Desk Application configuration
##      [APSExpire]         Daily processing job definitions
##      [ODBC]              ODBC Queries
##      [FPS]               General Forgotten Password Support (FPS)
##      [FPS-Identify]      Tell FPS how to identify the user
##      [FPS-Verify]        Tell FPS how to verify the user
##      [FPS-Change]        Tell FPS how user can change their password
##      [FPS-Confirm]       Tell FPS how to communicate completion
##      [FPS-No Mail]       Tell FPS how to handle mail problems
##      [FPS-Errors]        Tell FPS how to handle other errors
##
## The first section is very long. In the interest of navigational,
## aids, "bouys" have been placed in this section. These are just 
## comments at the beginning of "interesting" parts of the section 
## that you can search for as needed. Note that these markers are only
## comments and not keywords:
##
##      ##MACROS##                  Though not required to be at top,
##                                  this is where DEFINE macros have
##                                  been set up.
##      ##USER TYPES##              User type definitions
##      ##GENERAL##                 General settings (after all comments)
##      ##WRITEBACK##               LDAP Writeback settings
##      ##CONTENT##                 Password Content Control
##      ##ATTRIBUTE MATCHING##      Profile attribute matching
##      ##REGULAR EXPRESSIONS##     Match & No Match keywords
##      ##ALLOWED CHARACTERS##      Allowed and Disallowed Characters
##      ##RUNTIME##                 Run-time (auth) testing
##      ##FAILURE COUNT##           Failure Count processing
##      ##PASSWORD EXPIRATION##     Password expiration settings
##      ##ACCOUNT EXPIRATION##      Account Expiration & Purge settings
##      ##REDIRECTS##               Event Redirections
##      ##GENERATIONAL REDIRECTS##  Generation Redirects, Message of 
##                                  the day, etc.
##      ##MAIL FILES##              Mail to send on events.
##
## If this file does not exist, an error is logged and default settings
## will be used. This may cause errors during operation.
##
## Errors that occur while parsing this file are logged, in detail, to
## a file called APS.cfg.yyyymmddhhmmss.LOG (or, under Unix, in a file
## with the same name as the configuration file with "<date-time>.log"
## appended). APS will log a message to the SiteMinder console stating
## that parsing errors occurred.
##
## The APSTestSettings utility will display most of the settings from
## this file that apply generically or to a specific user. If this file
## is changed, APSTestSettings can be used to test the new settings, 
## since the file will be parsed and any errors encountered will be 
## logged.
##
## See the documentation for APSTestSettings for details about its use.
##
## File Format
## -----------
## All blank lines are ignored and any line beginning with two forward 
## slashes ("//"), a pound sign ("#") or a semicolon (";") is 
## considered a comment. Embedded and trailing comments are not 
## supported.
##
## For the most part, each non-comment line consists of a keyword (or
## words) followed by an equal sign, followed by zero or more spaces,
## followed by the setting for that keyword.
##
## Keywords are not case-sensitive. Settings often are.
##
## By default, almost all options are disabled. Options should be 
## enabled as needed. Options should be set with care, as it is 
## possible to create situations where no password exists that can 
## satisfy all conditions. Even if it is possible, you should be 
## careful. Complex rules can confuse users.
##
## If the file is modified while APS is running, the changes will apply
## to the next user accessing the system or changing his password. The
## SiteMinder Policy Server services need not be restarted.
##
## There is a slight performance degradation due to the large number of
## comments in this file. However, because of file caching, it is only
## noticeable during startup and when the file changes. Thus, we highly
## recommend that the comments be left intact.
##
## If you do not wish to put LDAP passwords in the file in clear text,
## use the NPSEncrypt command line utility (supplied with APS) to 
## encrypt the password, then cut and paste its output into this file.
##
## The configuration is stored in a flat file (rather than in some
## distributed data store) intentionally. This gives us a much higher
## degree of configuration flexibility and portability. For example, if
## the Primary SiteMinder server always accesses a Primary LDAP server,
## there may be no need for Writeback settings, whereas a Backup 
## SiteMinder Server (that might be accessing a Back LDAP Server) might
## need Writeback settings.
##
## If multiple SiteMinder Policy Servers are used, a copy of this file 
## must exist on each of them. If the same configuration is to be used 
## on all, the site can use one of the many file replication utilities 
## available on the market. Thus, changing the file on one server would
## cause that change to be replicated to all other servers. CA Technologies 
## does not supply, support, or recommend any particular utility to
## perform this function for SiteMinder.
##
## DEFINED Macros
## --------------
## This file supports DEFINED Macros. DEFINE Macros will replace a
## symbolic value text within this file. To define a macro, use
## the syntax:
##
##      define X Y
##
## After this definition, anywhere that <X> appears will be replaced
## with Y. For example:
##
##      define LDAP_SERVER 127.0.0.1
##
##      LDAP Writeback Server=<LDAP_SERVER>
##
## In this case, the actual value for LDAP Writeback Server will be
## 127.0.0.1
##
## This is *incredibly* useful for separating environment-specific
## settings, reducing the errors which occur when an APS.cfg file
## is copied from one environment to another (such as DEV to QA to
## PROD). For example:
##
##      define CPW_SERVER myserver.security.com
##
##      Failure Redirect=http://<CPW_SERVER>/Failure.htm
##
## Macro names are not case sensitive. If a macro is referenced, but
## not defined, the reference is left intact.
##
## Macros are processed during file load. They are not evaluated per
## user, so there is little performance impact.
##
## Macros take effect only from the point where they are defined.
##
## If a Macro has the same name (case-insensitive) as a previously
## defined macro, the new value replaces the old one from that point
## down.
##
## DEFINE Macros can also be used with Evaluation classes and overrides
## (explained later) to make definitions environment independent:
##
##       define LDAP_SUFFIX   o=dev.Airius.com
##       @Admin=IsInGroup("cn=Admin,<LDAP_SUFFIX>")
##
## When the file is promoted into QA, only the DEFINE line needs to 
## change.
##
## Comment checking is performed *after* macro expansion, so the 
## following method can be used to make conditional (not overridden)
## settings:
##
##      define NO_MAIL ##
##      <NO_MAIL>Server=127.0.0.1
##
## When NO_MAIL is set to a comment character, the setting is turned
## off. If NO_MAIL has no value, then the mail server setting is
## valid. A very useful environment-specific setting (don't send
## email is DEV).
##
## If a macro is referenced, but not defined, APS will attempt to 
## locate an environment variable with the same name as the macro
## and will use its value (if one is found) for replacement.
##
## External Macro File
## -------------------
## Macros need not be defined in this file. They can also be defined
## in a separate file called "APS-Macros.cfg" located on the same
## directory as the APS.CFG file.
##
## However, the external macro file will not automatically be loaded.
## It will only be loaded when the "Use External Macros" keyword is
## used in this file. Note that the external macro file can be loaded
## more than once (which might be useful if you want to change a
## value temporarily). It requires explicit loading in order to 
## maintain backward compatibility.
##
## The external macro file is *extremely* useful. It allows a site to
## define machine-specific settings externally to the APS.CFG file.
## Thus, as an APS.CFG file is copied between Policy Servers, either
## from environment to environment (DEV to QA, for example) or within
## an environment, settings can "adapt" to the proper machine.
##
## For example, the APS.cfg file might contain:
##
##      @QA_Users=<QA_DEF>
##
## In the DEV and QA environments, the APS-Macros.cfg file might 
## contain:
##
##      define QA_DEF IsInGroup("cn=Quality Assurance,o=Airius.com")
##
## Whereas, in the production environment, the APS-Macros.cfg file
## might contain:
##
##      define QA_DEF FALSE
##
## Another example, used with multiple Policy Servers within the
## *same* environment, might be (in the APS.cfg file):
##
##      LDAP Writeback Server={<USE_WRITEBACK>}127.0.0.1
##
## On a policy server that directly accesses the master, the 
## APS-Macros.cfg file would contain:
##
##      define USE_WRITEBACK TRUE
##
## On a policy server that does not access the master by default, the
## APS-Macros.cfg file might contain:
##
##      define USE_WRITEBACK FALSE
##
## Note that macros can be defined anywhere in this file, but it is
## most useful (and avoids confusion) if they are defined at the top
## of the file.
##
## Setting Overrides
## -----------------
## Most settings can be overridden using a special "override" notation.
## This notation is described fully in the APS documentation.
##
## Overrides are always defined within curly braces ("{" and "}") and
## appear immediately after the equal sign for a setting. For example,
## to provide an override for the "Minimum Length" setting, use the
## following:
##
##      Minimum Length={<override expression>}5
##
## If the current user satisfies the specified override definition,
## the setting will be considered for use.
##
## When specifying an override, note that it may not always be used, 
## even if it applies. APS will examine ALL values for a given setting,
## using all that apply for the current user. If multiple values apply,
## including a default value, then the MOST RESTRICTIVE value will be  
## used. For example, suppose the following two settings were 
## specified:
##
##      Minimum Length=5
##      Minimum Length={givenname="Eric"} 4
##
## Users with a first name of "Eric" would have a minimum length of 5, 
## not 4, since both settings apply and 5 is more restrictive than 4.
##
## When multiple string settings might apply, usually the *last*
## applicable setting will be used (sometimes something other than the
## last will be used, as noted in the text describing the specific 
## setting).
##
## Override expressions are logical (boolean) expressions. Expressions
## can compare a user's attribute value with a constant, test certain
## functions, test a context macro against a constant or some 
## combination.
##
## Individual expressions may be connected using logical operators.
## The following logical operators are supported:
##
##      NOT or !        Logical NOT
##      AND or & or &&  Logical AND
##      OR or | or ||   Logical OR
##      XOR or ^        Logical Exclusive OR
##      TRUE		    Constant TRUE
##	    FALSE		    Constant FALSE
##
## Logical operators are optimized to "short-circuit" (not evaluate a
## second operand if the result of the operator is already decided).
##
## The following comparison operators are supported. Note that there 
## are both case-sensitive and case-insensitive versions of each.
##
##      =               Case sensitive equality compare
##      ~=              Case insensitive equality compare
##      >               Case sensitive greater than compare
##      ~>              Case insensitive greater than compare
##      <               Case sensitive less than compare
##      ~<              Case insensitive less than compare
##      >=              Case sensitive greater than or equal compare
##      ~>=             Case insensitive greater than or equal compare
##      <=              Case sensitive less than or equal compare
##      ~<=             Case insensitive less than or equal compare
##      STARTS_WITH     First operand must start with second (case sensitive)
##      ENDS_WITH       First operand must end with second (case sensitive)
##      CONTAINS        First operand must contain second (case sensitive)
##      ~STARTS_WITH    First operand must start with second (case insensitive)
##      ~ENDS_WITH      First operand must end with second (case insensitive)
##      ~CONTAINS       First operand must contain second (case insensitive)
##
## All comparison operators require an (unquoted) attribute name as the
## first operand and a (quoted) constant for a second operand. 
## Furthermore, the first operand (the attribute) can be qualified by 
## "SOME" or "ALL". "SOME" indicates that if at least one value of the 
## (multivalued) attribute compares true, then the result is true. If 
## "ALL" is specified, the all values of the (multivalued) attribute 
## must compare true in order for the condition to be true. SOME is the 
## default. For example:
##
##     givenname~="Eric"
##
## If givenname is a multivalued attribute, then if any (because SOME 
## is the default) value of the givenname attribute is "Eric" (case-
## insensitive), the result is TRUE. This is equivalent to:
##
##     SOME:givenname ~= "Eric"
##
## On the other hand,
##
##     ALL:givenname ~= "Eric"
##
## would require that all of the values of givenname match "Eric" 
## (case-insensitive). While this is not a viable example, the 
## following might be:
##
##     ALL:givenname ~STARTS_WITH "E"
## 
## This, of course, could be further qualified as:
##
##     NOT ALL:givenname ~STARTS_WITH "E"
## 
## Note that new users have no attribute values at evaluation time, so
## these compares are essentially useless in those cases. This 
## typically applies to the self-registration process (additionally, 
## APS cannot check the password against user attributes, since the 
## user record does not yet exist). This problem is typically solved 
## by assigning the new user a random password during the registration 
## process and then forcing the user to change their password at first 
## login (when the user is no longer a new user --- the user record 
## exists in the directory).
##
## Some functions are also supported. Almost all functions take a 
## single constant, quoted argument. Most function calls will work with 
## new users (IsInGroup is an exception, new users cannot be in a 
## group). All functions return TRUE or FALSE.
##
##      At("<some DN>") or In("<some DN>")
##      Above("<some DN>") or Over("<some DN>")
##      Below("<some DN>") or Under("<some DN>")
##      IsInGroup("<group>")
##      IsNull("<attribute Name>")
##      IsInNamespace("<namespace>")
##      IsInDirectory("<directory id>")
##      IsNew()
##      IsLDAP()
##      IsODBC()
##      IsInWindows() or IsWin() or IsWinNT()
##      Self()  <-- Only allowed in APSAdmin section
##
## Thus, the following might be useful:
##
##      IsInGroup("cn=Administrators,o=Airius.com")
##
## Parentheses can be used to change the order of evaluation. 
## For example:
##
##      (IsLDAP() AND IsInGroup("cn=Admin,o=Airius.com")) OR (IsODBC() AND IsInGroup("Admin"))
##
## Since the evaluator short circuits, ODBC users will never evaluate 
## the LDAP IsInGroup call.
##
## There are two functions that require TWO arguments:
##
##      AnyBitSet(<attribute>, <integer>)
##      AllBitsSet(<attribute>, <integer>)
##
## These functions return true if certain bits are set in the numeric
## attribute specified by <attribute>. The bits are defined by the
## <integer> mask. 
##
## AnyBitSet will return true if any of the bits specified by the mask
## are set. AllBitsSet will return true *only* if *all* of the bits in
## the mask are set.
##
## Nothing outside of quotes is case sensitive (attribute names, 
## function names, textual operators, etc.)
##
## User Classes
## ------------
## The evaluator supports user classes as well. A user class can be 
## defined *anywhere* in this file, using the format:
##
##       @classname=<expression>
##
## Such as:
##
##       @Administrator=IsInGroup("cn=Admin,o=Airius.com")
##
## User classes can be referenced anywhere in an override, such as:
##
##       Minimum Length={@Administrator} 12
##       Minimum Length={@Administrator AND givenname="Eric"} 14
##
## User class names are NOT case-sensitive. They are very useful for 
## defining classes of users once in the file, then referencing the 
## override in many places.
##
## User classes must be defined before they are used. Duplicate 
## definitions are not allowed.
##
## The class definition (like all override expressions) is parsed at
## load time, but not evaluated until run time.
##
## Context Macros
## --------------
## Context Macros (not to be confused with DEFINE macros) can be passed
## from an Active Expressions in the param field or exist only within
## the context of a specific setting. They are typically used to pass 
## REALM or APPLICATION information at run-time.
##
## Context macros can appear anywhere that an attribute name can appear.
##
## Macro names are prefixed with a percent sign ("%").
##
## For example:
##
##        Immediate Change Redirect={@Administrator AND %App~="Main"} SmCPW.exe
##
## A note about "Old Style" overrides
## ----------------------------------
## Prior versions of APS supported a different override notation (using 
## square brackets) that only applied to the user's location in an LDAP 
## DIT. This notation is supported for backwards compatibility (it is 
## converted to  function calls), but is not recommended and should be
## manually converted as soon as possible.
##
## Performance
## -----------
## The evaluator has been *highly* optimized and is very fast. All 
## results, both intermediate and final, are cached for each user, so 
## that identical clauses will not be re-evaluated. In other words, 
## once a given comparison is made, it will not be made again 
## (regardless of the use of classes), the cached result will be used 
## instead.
##
## While user classes might appear to improve performance, they have 
## very little impact (either way). However, they improve readability 
## of this file and will reduce data entry error, since overrides can 
## be defined for classes, rather than repeating a complex definition.
##
## Testing Expressions
## -------------------
## APSTestSettings is a utility provided with APS for testing both
## the contents of this file (as described above) and for testing
## the lexer (the part of code that breaks up an expression) and the
## parser (the part of code the evaluates and expression). It can run
## in 3 modes. See the APS documentation for the complete description
## of APSTestSettings and its operation.
#######################################################################

#######################################################################
## It is generally a good idea to define macros at or near the top of 
## the file
#######################################################################

##MACROS##

// Uncomment if APS should use the external macro file APS-Macros.cfg

;;Use External Macros


// Set the following to blank to turn on all mail

define NO_MAIL ##
;;define NO_MAIL


define UNPROTECTED_PATH     http:/
define CPW_PATH             http:/CPW/SmCPW.exe
define LICENSE_URL          http:/License.htm
define MOTD                 http:/MOTD.htm
define SMTP_SERVER          127.0.0.1
define MAIL_LOG             M:/BIN/APSMail.Log
define MAIL_PATH            M:/Bin/Mail
define ALLOW_APSADMIN       true
define FPS_PATH             http:/FPS/
define FPS_FORM_EXTENSION   asp

#######################################################################
## It is often useful to define user classes at the top of the file, 
## though they can be defined anywhere.
#######################################################################

##USER TYPES##

;;@Administrators=IsLDAP() AND IsInGroup("cn=Administrators,o=Airius.com")
;;@Testers=IsLDAP() AND IsInGroup("cn=QA,o=Airius.com")
@HelpDesk=false
@HelpDeskManager=uid="erict"

#######################################################################
## General Settings
#######################################################################

##GENERAL##

///////////////////////////////////////////////////////////////////////
// Turn on tracing in APS routines. Some additional tracing/debugging 
// can be turned on using the Trace and Debug keys in the SmPortal.cfg
// file on the client side.
//
// This keyword CANNOT be overridden on a per-user basis.
///////////////////////////////////////////////////////////////////////

Trace

///////////////////////////////////////////////////////////////////////
// Control how long to wait for User Directory calls to complete. Note
// that this value is for each call, not overall time. If this time
// limit is exceeded for a single call, a timeout error will result.
// The default is zero (no limit or limit enforced by driver). In 
// general, this setting should be used only with great care, since it
// may cause timeout failures.
//
// This setting is specified in seconds. The maximum is 120 (2 minutes).
//
// If an override is required, it must be a restricted override. 
// That is, it can reference the Directory, but not the user.
//
// This setting is supported for ODBC and LDAP directories only.
///////////////////////////////////////////////////////////////////////

Timeout=0

///////////////////////////////////////////////////////////////////////
// Control how long to sleep between checks to see if a User Directory 
// call has completed. Lower numbers indicate that the driver should be
// checked more frequently. This may improve response time for the 
// current user, but will increase overall CPU utilization. Higher 
// numbers will decrease user responsiveness, but will use less CPU.
//
// This setting is specified in thousandths of a second. The minimum
// value is 10 milliseconds (1/100 second) and the maximum is 1000 
// milliseconds (1 second). Default is 100 milliseconds (1/10 second).
//
// If an override is required, it must be a restricted override. 
// That is, it can reference the Directory, but not the user.
//
// This setting is supported only for ODBC directories. LDAP 
// directories support timeouts only.
///////////////////////////////////////////////////////////////////////

;;Poll=100

///////////////////////////////////////////////////////////////////////
// The IGNORE setting allows a site to specify that selected users in
// their SiteMinder User Directories should be ignored completely by 
// APS. If the condition is true for a particular user, that user will
// be ignored by APS DURING AUTHENTICATION ONLY. Note that Change 
// Password and APSAdmin operations can still be performed, unless 
// these operations are forbidden using SiteMinder Policies. In 
// addition, the APS API nor FPS honor this keyword. To disallow
// users from FPS, using the Allow/Disallow keywords in the FPS
// section.
///////////////////////////////////////////////////////////////////////

;;Ignore={ isInGroup(<IgnoreUsersGroup>) } true

///////////////////////////////////////////////////////////////////////
// The DISABLE setting allows a site to use existing disabled statuses
// and flags in their user directories. If the override condition is
// true, then APS will consider the user disabled, as though APS itself
// had disabled the user. The *value* of the setting is the REASON CODE
// that will be available via macros to email templates and redirection
// URLs.
// The AllBitsSet and AnyBitsSet functions are particularly useful for
// this setting.
///////////////////////////////////////////////////////////////////////

;;Disable={ userStatus~="Terminated" } Released

#######################################################################
## LDAP Settings
#######################################################################

///////////////////////////////////////////////////////////////////////
// The Writeback settings indicate where APS should write information 
// when rewriting to an LDAP directory. This is used primarily for when 
// SiteMinder is reading from a replicant (consumer) and APS must write 
// back to a master (producer). Instead of attempting the write to the 
// (read-only) replicant, which will ALWAYS fail, APS will always write 
// to the Writeback server instead (it will still read from the server 
// from which the user was read). 
//
// If you KNOW that you are going to be doing referrals on writebacks 
// (if SiteMinder reads from a replicant), use these settings. 
//
// The password may be encrypted using the NPSEncrypt command line
// utility.
//
// If the port is different than the default (389), it should be 
// specified on the server name, such as 127.0.0.1:893
//
// You can override Writeback information. This is best done using
// the DIT location functions, but, if selective replication is
// being used, any override can be used.
//
// These settings are used in all cases. However, APSExpire does not
// support LDAPS (LDAP over SSL).
///////////////////////////////////////////////////////////////////////

##WRITEBACK##

;;LDAP Writeback Server=127.0.0.1
;;LDAP Writeback DN=cn=Directory Manager
;;LDAP Writeback Password=[NDSEnc-A]xcDaYCgO2O8oZSEG2h4)2EOaCq2
;;LDAP Writeback Use SSL=no

///////////////////////////////////////////////////////////////////////
// If this setting is enabled, when APS disables a user, it will NOT
// put the user in a Disabled group. Instead, it will set the Disabled
// Until date (in an LDAP entry ONLY) to FOREVER, effectively 
// disabling the user permanently. 
//
// This feature was new at APS Version 3.0. It provides a considerable
// performance improvement for very large sites, in that large groups
// are not used for disabling users. However, it is a change to 
// existing functionality and may impact user administration tools (the
// tools used to reset the user).
//
// This setting supports overrides, though the confusion factor 
// increases if this is done.
//
// "External Disables" are used only for LDAP entries (if this setting
// is turned off). ODBC directories always use internal disables.
///////////////////////////////////////////////////////////////////////

Use Internal Disables

///////////////////////////////////////////////////////////////////////
// APS always searches an entire LDAP directory for disabled groups.
// There are several groups that APS might use to disable users (custom
// groups will be honored by APS, but APS will not actually add users
// to these groups). If APS needs to add a user to one of these groups,
// it will locate a group with the correct name anywhere in the DIT.
// However, if it does not find one, it will create the group (this
// is all assuming that Use Internal Disables is not in effect).
//
// When APS needs to create such a group, the LDAP Disabled Groups
// keyword specifies the CONTAINER where APS will create this group.
//
// Note that if the group exists anywhere in the system, APS will
// never create it, so they can all be prebuilt and this keyword
// will have no effect.
//
// This keyword only affects LDAP directories.
//
// Previous versions of APS used this keyword to control where to
// search for disabled groups as well. This functionality has changed.
// While it is possible that this change may impact a site, it
// is unlikely.
///////////////////////////////////////////////////////////////////////

;;LDAP Disabled Groups=o=nds.com

///////////////////////////////////////////////////////////////////////
// Prior to version 3.0 of APS, APS stored its information for LDAP
// users in a Binary Large Object (BLOB). If your site upgraded from a 
// pre-3.0 release of APS, define the attribute used to store the APS 
// blob previously. The default is "audio".
//
// If the conversion process (APSNewSchema) retained the old blob,
// it also recorded a checksum of that blob. APS 3.0 uses this setting
// to make sure that the Blob hasn't changed (presumably by an old
// utility that hasn't been upgraded at the site).
//
// This setting is only used if the checksum is present in the user
// record. To delete all old blobs and the checksums, use the -X
// option of APSNewSchema. Once the data is cleaned up, it doesn't
// hurt anything to leave this setting in place (since no checksums
// will be seen).
// 
// This value does not support per-user overrides.
///////////////////////////////////////////////////////////////////////

LDAP Blob=audio

///////////////////////////////////////////////////////////////////////
// This keyword will cause APS to check for the existence of an LDAP
// password before expiring it or requiring it to be changed. Note
// that this was a NEW feature at version 2.0 and REQUIRES that the
// Directory Manager credentials be entered into the SiteMinder
// policy GUI for EACH LDAP directory (it only impacts LDAP). It will
// also have a small impact on performance. It should be used at
// sites where some users will be accessing the system using 
// authentication schemes that do not use passwords (and thus the
// user record may not have passwords)
//
// If this keyword appears without a setting, it turns on the feature.
//
// This setting can be overridden on a per-user basis.
///////////////////////////////////////////////////////////////////////

;;Check LDAP Password Existence=Yes

#######################################################################
## Settings for controlling password content
##
## These settings are used only when the user changes their password.
##
## They may or may not impact Administrators resetting user passwords,
## depending on whether a site's user administration facilities call
## APS for password validation.
#######################################################################

##CONTENT##

///////////////////////////////////////////////////////////////////////
// Control desired password length
//
// Minimum must be at least 4 and maximum cannot be greater than 32
//
// If the minimum is greater than the maximum (an unreasonable
// requirement), the maximum is increased to the minimum and a 
// message is logged to the Policy Server console. Note that this case
// is not detected until a password is changed (because of overrides).
///////////////////////////////////////////////////////////////////////

Minimum Length=4
Maximum Length=32

///////////////////////////////////////////////////////////////////////
// Control required password content
// 
// Note that "symbols" are defined as the characters
// "~@#$%^&*()_-+={}[]<>/\|"
//
// To turn off specific checking, either comment out or set to zero
//
// It is very easy to set up impossible combinations here.
///////////////////////////////////////////////////////////////////////

Minimum Letters=0
Minimum Digits=0
Minimum Alphanumeric=0

Minimum Punctuation=0
Minimum Symbols=0
Minimum Other=0

///////////////////////////////////////////////////////////////////////
// The following two settings should be used with care. They work 
// consistently only in English. Other languages may pose problems.
// The reason is that upper and lower case are only recognized as
// far as the letters A through Z are concerned. Other languages
// support various diacritical marks (accents, tildes, umlauts, etc.) 
// that have both upper and lower case versions. APS does *not* 
// recognize these characters as upper or lower case (or as letters
// at all, for that matter). To support such, use the Regular
// Expressions (Match and No Match) below.
///////////////////////////////////////////////////////////////////////

Minimum Upper Case=0
Minimum Lower Case=0

///////////////////////////////////////////////////////////////////////
// Control required password content combinations.
//
// You can require a minimum number of character *types* in a 
// password using the "Minimum Combinations" setting below.
//
// This controls the MINIMUM number of types required. In order
// to satisfy a specific type, the new password must contain a
// number of characters matching that type specified by one of
// the "Combination Xxxxx" settings.
//
// Another way to look at this is to consider that a new 
// password gets one "point" for each of the "Combination Xxxx"
// settings that it satisfies. The password must then have a
// minimum number of points equal to "Minimum Combinations".
//
// "Minimum Combinations" can have a value of from zero to 7.
//
// If not enough "Combination Xxxx" settings are non-zero to
// satisfy "Minimum Combinations", the settings are all ignored
// and a warning is placed into the log.
//
// If "Combination Xxxx" settings are non-zero, but "Minimum
// Combinations" is zero or not set, all settings are ignored
// and a warning placed into the log.
//
// To turn off specific checking, comment is out.
///////////////////////////////////////////////////////////////////////

;;;Combination Letters=0
;;;Combination Upper Case=0
;;;Combination Lower Case=0
;;;Combination Digits=0
;;;Combination Alphanumeric=0

;;;Combination Punctuation=0
;;;Combination Symbols=0
;;;Combination Other=0

;;;Minimum Combinations=0

///////////////////////////////////////////////////////////////////////
// Control how many duplicate characters in a row generates an error.
//
// Thus, if this setting is 3, the following passwords would be
// disallowed:
//
//	ABCCC
//	abbbc
//
// This testing may or may not be case sensitive, depending on the 
// Force Case setting below (and subject to the multi-lingual caveats).
//
// To turn off this checking, set to zero or comment out.
///////////////////////////////////////////////////////////////////////

Maximum Repeat=3

///////////////////////////////////////////////////////////////////////
// Control password reuse
// 
// To turn off checking, set to zero or comment out.
//
// APS will always *store* the larger of the Count or one year, 
// regardless of these settings. This is so that these settings can 
// be turned on later without repercussions.
//
// If you wish to limit users to changing their password once per day,
// APS cannot do it for you. However, the purpose of such a limitation 
// is to prevent users from setting a new password, then setting it 
// back immediately. To accomplish the same purpose, set Reuse Delay to
// 1. The user can then change their password as many times as they
// want, but will not be able to set it back for 1 day.
//
// If you still want to limit password changes to once per day, use
// a custom change password form and pass it a userattr response of
// "smapsLastPasswordChange". Your form should display a proper error
// and refuse to display. Be careful to handle cases where the
// user is forced to change their password.
//
// Note that there is an internal restriction on the length of the 
// password history of 24k. Thus, programmatic password changers
// (that might be used for volume testing) might be able to re-use
// a password before these restrictions are satisfied. Only an
// automated password changer can change it frequently enough. The
// password history has duplicate compression, so changing it and
// changing it back programmatically will not overly enlarge the 
// history.
//
// These settings support override expressions.
///////////////////////////////////////////////////////////////////////

Reuse Count=0
Reuse Delay=0

///////////////////////////////////////////////////////////////////////
// Control how much the password must change
//
// There are two settings here. To turn off checking, set Percentage
// to zero or comment it out.
//
// Percentage checking takes two forms:
//      If Percentage Sequencing is OFF, then the percentage checking
//      is on overall character counts. APS counts the number of each
//      type of character and the new password cannot share 
//      "Percentage" percent of common characters. 100% could make life
//      difficult for users.
//
//      If Percentage Sequencing is ON, then the percentage checking is
//      on a character by character basis. "Percentage" percent of each
//      character position must change. This does NOT detect a change 
//      between BASEBALL12 and 12BASEBALL.
//
// Both settings support overrides.
///////////////////////////////////////////////////////////////////////

Percentage=0
;;Percentage Sequencing

///////////////////////////////////////////////////////////////////////
// Should we check passwords against user attributes? If so, how many 
// characters indicates an illegal match?
//
// You can turn this checking off by setting it to zero or commenting
// it out.
//
// Any value less than 4 will be ignored by APS (4 will be used).
//
// If this value is 4, for example, then no four character sequence in
// the user's directory entry or DN can be contained, forward or 
// backward, in the new password.
//
// This setting is useful for preventing the use of your user id as a
// password, for example. Organizational Units and other containers
// above the user are *not* checked. However, the user's DN *is* 
// checked.
//
// Note that APS cannot do this check for new users because they do not
// exist at the time that the password is checked for validity (thus,
// we don't know what the attribute values are). This typically only
// affects user self-registration, since adding users from a help desk
// or by an administrator are often affected by other rules. One 
// solution is to initially create a user with a random (unvalidated)
// password and force the user to change it when they first login.
// Since the user record will then exist, the new password can be 
// checked against attributes properly.
//
// Prior to version 4.0, this setting was called "LDAP Attribute Match
// Maximum". This name is still supported (but deprecated). The new
// name is "Attribute Match Maximum" to reflect support for directories
// other than LDAP.
//
// This setting is ignored in Windows NT directories.
//
// This setting can be overridden with an override expression.
///////////////////////////////////////////////////////////////////////

##ATTRIBUTE MATCHING##

;;Attribute Match Maximum=5

///////////////////////////////////////////////////////////////////////
// When we check passwords against user attributes, this keyword 
// specifies attributes that should NOT be checked. Note that 
// "objectclass" will NEVER checked. If objectclass will contain
// items that should be checked, put the words into the dictionary.
//
// No attributes will be checked at all if the match maximum is zero.
//
// Prior to version 4.0, this setting was called "Exclude LDAP 
// Attributes". This name is still supported (but deprecated). The new
// name is "Exclude Attributes" to reflect support for directories
// other than LDAP.
//
// For LDAP directories, APS always excludes objectclass and all of 
// the smapsXXX and smfpsXXX attributes. If objectclass names should
// be disallowed, put the names into the Dictionary.
//
// This setting is ignored in Windows NT directories.
//
// This setting can be overridden on a per-user basis.
///////////////////////////////////////////////////////////////////////

Exclude Attributes=audio

///////////////////////////////////////////////////////////////////////
// When we check passwords against user attributes, this keyword 
// specifies that certain attributes should be parsed into words 
// (delimited by whitespace). Each "word" in the attribute greater than
// 2 characters in length will be checked.
//
// No attributes will be checked at all if the match maximum is zero.
//
// Prior to version 4.0, this setting was called "Parse LDAP 
// Attributes". This name is still supported (but deprecated). The new
// name is "Parse Attributes" to reflect support for directories
// other than LDAP.
//
// This setting is ignored in Windows NT directories.
//
// This setting can be overridden.
///////////////////////////////////////////////////////////////////////

Parse Attributes=cn

///////////////////////////////////////////////////////////////////////
// Control password complexity. APS can numerically evaluate the 
// complexity of a password. If the complexity of the new password does
// not exceed the specified value, the password is not allowed.
//
// If you use this setting, you should *NOT* use the settings that
// require specific numbers of letters, digits, etc.
//
// To turn off this checking, set to zero or comment out.
//
// The default error message for this test reads "Password not complex
// enough". This message will almost certainly confuse users. Typical
// sites using this setting will change the error message to a redirect
// to a page describing desirable password content.
//
// This setting can be overridden.
///////////////////////////////////////////////////////////////////////

;;Complexity=30

///////////////////////////////////////////////////////////////////////
// Control whether passwords should be force to upper or lower case.
// Possible values are "lower", "upper" or "none". The default is 
// "none". CA Technologies does not recommend the use of this keyword, since
// it reduces the total combinations of passwords, easing the job of
// programmatic attacks.
//
// If this setting is specified, it will automatically affect change
// passwords (both old and new will be converted before use). However,
// to automatically force password case during authentication, you will
// have to use the Authentication Scheme Wedge (see the APS 
// documentation).
//
// Do not change this setting if passwords already exist in your 
// system. APS will force the OLDPASSWORD (during password change),
// so legacy users will not be able to login or change their passwords
// if they are not already stored with the correct case.
//
// This setting may also affect such things as the Minimum Upper Case
// Minimum Lower Case and Maximum Repeat settings, since those settings
// are checked *after* the case of the new password has been changed.
//
// This setting only works consistently in English. Other languages 
// may pose problems. The reason is that upper and lower case are only 
// recognized as far as the letters A through Z are concerned. Other 
// languages support various diacritical marks (accents, tildes, 
// umlauts, etc.) that have both upper and lower case variants. APS 
// does *not* recognize these characters as upper or lower case 
// (or as letters at all, for that matter). 
//
// To turn off this checking, set to none or comment out.
//
// This setting can be overridden.
///////////////////////////////////////////////////////////////////////

;;Force Case=none

///////////////////////////////////////////////////////////////////////
// The following two keywords force new passwords to match or not match
// a specified pattern, or regular expression. Unlike most keywords in
// this file, each of these keywords may appear as many times as
// required, with or without overrides (the same override may appear
// more than once). ALL applicable patterns will be applied.
//
// Each value must include two pieces, the error key and the pattern,
// separated by one or more spaces.
//
// The error key is an index into the APS.lang file for the error 
// message to display if the new password violates the pattern.
//
// The pattern is a regular expression that the new password must
// match or not match (depending on the keyword).
//
// In the regular expression:
//    `\w*' matches any sequence of characters (zero or more)
//    `\w?' matches any single character
//    [SET] matches any character in the specified set,
//    [!SET] or [^SET] matches any character not in the specified set.
// 
// A set is composed of characters or ranges; a range looks like
// character hyphen character (as in 0-9 or A-Z). [0-9a-zA-Z_] is the
// minimal set of characters allowed in the [..] pattern construct.
// Other characters are allowed.
// 
// To suppress the special syntactic significance of any of `[]*?!^-\',
// and match the character exactly, precede it with a `\'.
//
// For example, to require a single upper case character (without using
// the Minimum Upper Case setting), use:
//
//      Match=ERR_ONE_UPPER \w*[A-Z]*
//
// If other characters should count as upper case, add them to the set:
//
//      Match=ERR_ONE_UPPER \w*[A-ZÑ]*
//
// This is the recommended way to handle multi-lingual sites.
//
// A typical use for these settings (and the original, driving 
// requirement) was for sites to require a single digit, but not as the
// first or last character of the password.
//
//      No Match=ERR_NO_STARTING_DIGIT ^[0-9]*
//      No Match=ERR_NO_ENDING_DIGIT \w*[0-9]$
//
// Note that in all cases, the error key must be added to the LANG
// files (along with an appropriate error message).
//
// To turn off this checking, comment out all values.
///////////////////////////////////////////////////////////////////////

##REGULAR EXPRESSIONS##

;;Match=<error key> <regExpr>
;;NoMatch=<error key> <regExpr>

///////////////////////////////////////////////////////////////////////
// NEW IN APS 4.1
// The following two keywords control what characters are allowed and
// not allowed in a new password. Unlike most keywords in this file, 
// each of these keywords may appear as many times as required, with or 
// without overrides (the same override may appear more than once). ALL 
// applicable settings will be applied.
//
// Each value constains a list of characters. The list may or may not
// be surrounded with quotes (if the setting begins and ends with a
// quote, the quotes will be removed). This may be necessary since
// leading and trailing spaces are always ignored for settings.
//
// Duplicate characters are supressed.
//
// If NO allowed characters are specified, then all characters are
// allowed (except as specified in the disallowed list).
//
// If NO disallowed characters are specified, then all characters
// are allowed (except for those excluded from the allowed list).
//
// APS does not detect characters that are duplicated in both lists.
// If a character appears in both lists, it will be disallowed.
//
// To turn off this checking, comment out all values.
///////////////////////////////////////////////////////////////////////

##ALLOWED CHARACTERS##

;;Allowed Characters="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ 0123456789"
;;Disallowed Characters=")("

#######################################################################
## Settings for run-time password checking
##
## These settings are used during the Authentication process to 
## deterimine if the user can log in or if APS must force the user
## to do or see something before accessing the site.
#######################################################################

##RUNTIME##

///////////////////////////////////////////////////////////////////////
// When users are disabled (under LDAP only), their password got
// set to nonsense by default (pre-version 2.0). If this setting is 
// turned ON (it is off by default), then passwords will be scrambled
// when the user is disabled, thus preventing the user from accessing
// other applications that may use the same LDAP directory. Generally,
// it is not needed.
//
// This setting supports overrides.
///////////////////////////////////////////////////////////////////////

;;Reset Password

///////////////////////////////////////////////////////////////////////
// New to APS Version 3.0, this keyword tells APS to force a user to
// change their password if it detects that the password was changed 
// through an interface *other* than APS. In other words, if APS
// detects that the password changed, and APS didn't do it, should the 
// user be force to change their password. This makes administrative 
// resets simpler (programmatically), since APS can automatically 
// force the change.
//
// This setting *requires* that cn=Directory Administrator be used
// as the directory credentials for LDAP directories. Other priviledged
// credentials will not work.
//
// This setting supports overrides.
///////////////////////////////////////////////////////////////////////

;;Auto Force Change

///////////////////////////////////////////////////////////////////////
// When a user successfully logs into SiteMinder, should APS reset the 
// FPS lockout counter?
//
// This setting supports overrides.
///////////////////////////////////////////////////////////////////////

;;Reset FPS Lockout

#######################################################################
## "n" strikes processing
#######################################################################

##FAILURE COUNT##

///////////////////////////////////////////////////////////////////////
// The maximum consecutive password failures ("n" strikes and you're 
// out). This value can be zero, or 3-9 inclusive. The recommended
// setting is 5. This setting is *separate* from the SMRETRY setting
// supported on SiteMinder authentication forms. Please see the APS
// documentation for details.
//
// This affects failures both on login and change password (change
// password only if Max Failures On Change is not set).
//
// This setting supports overrides.
///////////////////////////////////////////////////////////////////////

;;Max Failures=3

//////////////////////////////////////////////////////////////////////
// A semicolon separate list of realm OIDs which need to be configured for
// separate MAX failures through 'Realm based Max Failures' setting.
// For these realm OIDs, 'MAX FAILURES' setting will not be applicable.
//
//////////////////////////////////////////////////////////////////////

;;Override Max Failure for Realm OIDs=
//////////////////////////////////////////////////////////////////////
// The maximum consecutive password failures ("n" strikes and you're 
// out) applicable on 'Override Max Failure for Realm OIDs' setting. 
// This value can be zero, or 3-9 inclusive. The recommended setting is 5. 
// This setting is *separate* from the SMRETRY setting supported on 
// SiteMinder authentication forms. Please see the APS documentation for details.
//
//
// This setting supports overrides.
//////////////////////////////////////////////////////////////////////
;;Realm based Max Failures=3

///////////////////////////////////////////////////////////////////////
// The maximum consecutive password failures ("n" strikes and you're 
// out) to be used FOR PASSWORD CHANGES ONLY. This value can be zero, 
// or 3-9 inclusive. The recommended setting is 5. If not set or zero,
// the setting for Max Failures (above) will be used.
//
// This setting supports overrides.
///////////////////////////////////////////////////////////////////////

;;Max Failures On Change=5

///////////////////////////////////////////////////////////////////////
// If we're to automatically reset failure counts after a specific
// amount of time, this setting controls how long the user is disabled.
// Note that additional attempts while disabled will cause the date/
// time when the account becomes auto enabled to be delayed by this
// amount.
//
// This setting supports overrides.
///////////////////////////////////////////////////////////////////////

Failure Count Timeout=30

///////////////////////////////////////////////////////////////////////
// ***** NOTE: New setting in APS 4.0
// How many minutes before we "forget" failure counts in memory? 
// If the user makes NO attempt to  login for this amount of time, the 
// in-memory failure count will be reset. This has nothing to do with
// Auto Reset Failure Count. It is the length of time that counts are
// "remembered", not how long the user is disabled.
//
// Prior to APS 4, the Failure Count Timeout setting was used for this
// value.
//
// If not set, this value will be internally set to 5 minutes.
// This setting is in minutes. This value will be IGNORED if it is
// less than 5 minutes (and 5 minutes will be used).
//
// This setting supports overrides.
///////////////////////////////////////////////////////////////////////

Failure Count Retention=5

///////////////////////////////////////////////////////////////////////
// If this setting is turned on, then users will not be permanently
// disabled when they reach the failure count (Max Failures), but will
// not be allowed to login until the timeout occurs. Any attempt to 
// login (good password or not) will reset the timer. 
//
// The user will be disabled using smapsDisableUntil. Note that if the
// user is disabled LONGER (or FOREVER), then auto-reset won't work,
// since APS will not overwrite the later date.
//
// This setting supports overrides.
///////////////////////////////////////////////////////////////////////

;;Auto Reset Failure Count

#######################################################################
## Password Expiration
#######################################################################

##PASSWORD EXPIRATION##

///////////////////////////////////////////////////////////////////////
// How many days before a password expires? From the date of the last
// password change (or Base Date), this number of days is added to 
// determine the PASSWORD SOFT EXPIRATION DATE.
//
// This setting supports overrides.
///////////////////////////////////////////////////////////////////////

Password Expiration=60

///////////////////////////////////////////////////////////////////////
// How many days before the password expires do we start warning the
// user that the password should be changed?
//
// This setting supports overrides.
///////////////////////////////////////////////////////////////////////

Expiration Warning=7

///////////////////////////////////////////////////////////////////////
// How many days before the password expires do we start warning the
// user that the password should be changed via APSExpire (offline)?
//
// If no settings exist for a particular user, the Expiration Warning
// setting (above) will be used instead.
//
// Note that multiple values may exist for this setting. If so, *ALL*
// applicable values will be used and APSExpire will attempt to issue
// warnings at each time period.
//
// This setting supports overrides.
///////////////////////////////////////////////////////////////////////

Offline Expiration Warning=21
Offline Expiration Warning=14
Offline Expiration Warning=7

///////////////////////////////////////////////////////////////////////
// Once password expiration is reached, we no longer treat password
// change as optional (it becomes required). How many days AFTER the
// password expires do we actually disable the user.
//
// The PASSWORD SOFT EXPIRATION DATE, plus this number of days, is the
// PASSWORD HARD EXPIRATION DATE.
//
// Prior to version 2.0, APS did not support this feature.
//
// If you do not wish users to ever be disabled because of password
// expiration, set this to a very high number. Then, when the password
// expires, the user will be in a force password change state every
// time the user logs in.
//
// If this value is zero, then passwords will immediately expire when
// the password soft expiration date occurs (subject to Grace Logins,
// below).
//
// This setting supports overrides.
///////////////////////////////////////////////////////////////////////

Expiration Grace=30

///////////////////////////////////////////////////////////////////////
// An alternative to a timed expiration is a grace expiration. This 
// setting specifies the maximum number of TIMES (not DAYS) that the
// user can log in during the grace period before the user will be
// disabled. Both the Expiration Grace (DAYS) and Grace Logins settings
// can be used at the same time.
//
// This setting supports overrides.
///////////////////////////////////////////////////////////////////////

Grace Logins=2

#######################################################################
## ACCOUNT Expiration & Purge
#######################################################################

##ACCOUNT EXPIRATION##

///////////////////////////////////////////////////////////////////////
// The maximum amount of time, in days, between logins allowed before a 
// user is disabled for inactivity. This setting is mostly used by the
// APSExpire utility.
//
// This setting supports overrides.
///////////////////////////////////////////////////////////////////////

Max Inactivity=365

///////////////////////////////////////////////////////////////////////
// If the real-time User Expiration utility (APSExpire) is used, then 
// a site can send warning mail to users before their account expires. 
// This setting controls how long before the user record expires such 
// mail is sent. Note that the mail may not actually be sent this 
// number of days before expiration, since the utility may not run on
// a daily basis. The  utility will generate mail when a user's record 
// will expire within  this number of days AND such mail has not 
// already been sent.
//
// This setting supports overrides.
///////////////////////////////////////////////////////////////////////

Inactivity Warning=10

///////////////////////////////////////////////////////////////////////
// APS will *never* actually delete a user record. However, this many
// DAYS after an account expires, APSExpire will report the account
// as "eligible for purge" (it won't actually purge, though). This
// allows sites to determine the inactive accounts.
//
// This setting supports overrides, so customer accounts could be
// retained for longer than employee accounts, for example.
///////////////////////////////////////////////////////////////////////

Purge After=30

#######################################################################
## Redirects
##
## When certain events are encountered in the authentication process,
## APS can redirect the user to specific pages. This section specifies
## the URLs to redirect users to when these events occur.
##
## When an event occurs during authentication, APS records the fact
## that the event has occurred. It CANNOT perform the redirection at 
## that time.
##
## In order to actually perform the redirection, additional 
## configuration settings must be created within the Policy Database.
## 
## IN EVERY REALM IN EVERY POLICY DOMAIN, you must check the boxes
## labelled "Enable Authentication Events" and "Enable Authorization
## Events". If these boxes are not checked, SiteMinder will not perform
## redirections, even if the rest of the settings are correct. Note
## that there is ONE EXCEPTION: the "Change Password" realm should NOT
## have these events enabled, otherwise users will end up in an 
## infinite loop when attempting to change their passwords.
##
## For each realm, there must also be THREE rules created, one for each
## of the following events: OnAuthAccept, OnAuthReject and 
## OnAccessAccept. All rules of the same type (for multiple realms in 
## the same policy domain) can be grouped together into Rule Groups.
##
## Each Policy Domain must have THREE Responses created, one for each
## Rule type.
##
## The Response for OnAuthAccept must have a single response of type
## OnAccept-Redirect. This should be an Active Expression using the
## following values (these values are case-sensitive):
##      Library     = smaps
##      Function    = SmApsRedirect
##      Parameters  = (see below)
##
## The Response for OnAuthReject must have a single response of type
## OnReject-Redirect. This should be an Active Expression using the
## following values (these values are case-sensitive):
##      Library     = smaps
##      Function    = SmApsRedirect
##      Parameters  = (see below)
##
## The Response for OnAccessAccept must have a single response of type
## OnAccept-Redirect. This should be an Active Expression using the
## following values (these values are case-sensitive):
##      Library     = smaps
##      Function    = AZRedirect
##      Parameters  = (see below)
##
## A single additional Policy must be created within the Policy Domain
## to tie everything together for this domain. The Policy should 
## reference all of the Rules (or Rule Groups) created above. Each
## Rule (or Rule Group) should be connected to the corresponding 
## Response. The Policy should apply to all users.
##
## PARAMETERS:
## -----------
## The Parameter field for these redirections can be used for some very
## powerful functionality.
##
## The parameter field is in the form:
##      <key>=<value>;<key2>=<value>;...;<default redirect>
##
## All fields are optional and the system works fine without specifying
## any parameters.
##
## The <default redirect> parameter, if used, must be the last section
## in the parameter list. It cannot contain an equal sign or a 
## semicolon (escape such characters with a backslash "\" or URL 
## encode them). If NO redirection is to be performed by APS, this is 
## where the user will be redirected to instead. This is used when 
## a site wants to use one of the redirect events, but it would 
## conflict with APS.
##
## As many Key/Value pairs as required may be specified. APS will 
## save these values. The character case for keys is ignored. If the
## same key is specified more than once, only the last value will be
## used.
##
## Values may contain attribute names surrounded by curly braces
## ("{" and "}"). Such attribute names (and the braces) will be 
## replaced by the attribute value from the user's directory entry.
##
## Redirects can be overridden. Each Key will be used as a Context
## Macro when evaluating overrides by referencing the Key name
## in the override, preceded by a percent sign ("%"). These names
## are not case-sensitive.
##
## When a redirect must be determined, APS will evaluate ALL redirects
## of the correct type defined in this file IN THE ORDER IN WHICH THEY
## APPEAR. The LAST one that applies will be used.
##
## To override a redirection setting, specify a Key/Value pair after
## the equal sign in the override, such as:
##
##      Failure Redirect={%LANG="EN"}http:/EnglishFailure.htm
##
## If the parameter of the redirect response defined in the Policy
## were "LANG={preferredLanguage}", then there will be a key called
## LANG with a value of the user's preferred language (from their
## directory entry). If the value from the user's entry were EN (for
## English), then the LANG key will have a value of "EN", thus this
## setting would be selected (assuming it is not superceded by another
## later setting).
##
## Of course, these keys can be used in combination with other 
## override capabilities:
##
##      Failure Redirect={%LANG="EN" AND @Admin}http:/EnglishFailure.htm
##      Failure Redirect={%LANG="EN" AND IsInGroup("Employee")}http:/EnglishFailure.htm
##
## This is most useful to select redirections based on REALM. APS does
## not support this directly, but it can easily be performed using this
## feature by specifying a Key called "REALM" in each response, with 
## a value appropriate for that realm. Overrides can then be defined in
## this file for each Realm. Realize that this is not truly tied to 
## the realm, it is only a key supplied as a parameter to the redirect.
##
## URL Translation
## ---------------
## Once a redirection URL has been selected, APS can perform 
## additional translations on that URL. In addition to the keys 
## supplied in the Active Expression parameter, the following Keys 
## will also be defined:
##      
##      Server          ->  The server component of the REQUESTED
##                          Resource URL.
##      Resource        ->  The resource component of the REQUESTED
##                          Resource URL.
##      Action          ->  The action component of the REQUESTED
##                          Resource URL.
##      Target          ->  The full URL of the REQUESTED resource.
##
## If the user context is defined (the user is authenticated), these
## keys will be defined as well:
##
##      UserName        ->  The user's full DN
##      UserPath        ->  The user's full path, including directory
##                          type and name.
##      DirPath         ->  The path to the directory server.
##      DirServer       ->  The directory server.
##      DirNamespace    ->  "LDAP:", "ODBC:" or "WinNT:", depending on
##                          the origin of the user.
##
## APS will take the resulting URL (or the default one specified
## in the parameter field) and replace any references to any key with
## its value. References to keys should be placed in the URL surrounded
## by angle brackets ("<" and ">"). To continue the example above:
##
##      http://www.mysite.com/TargetPage?Language=<LANG>
##
## would be translated to:
##
##      http://www.mysite.com/TargetPage?Language=EN
##
## Key names are NOT case-sensitive and values will be URL-encoded (so 
## Target will be encoded).
##
## In addition, any text between curly braces ("{" and "}") contained
## within the setting (but not immediately after the equal sign) will 
## be replaced (along with the braces) with equivalent values from the 
## user's directory entry. Note that this processing is only possible 
## if the user has been successfully authenticated. This text will not 
## be confused with an override, as overrides appear immediately after 
## the equal sign.
## An example might be:
##
##      http://www.mysite.com/TargetPage?Language=<LANG>&Name={givenname}
##
## would translate (for me) to:
##
##      http://www.mysite.com/TargetPage?Language=EN&Name=Eric
##
## If the URL contains another URL hard-coded into its query string, 
## the second URL should (almost MUST) be URL-encoded.
##
## SmCPW
## -----
## For some of these redirects, the target may be SmCPW, that component
## of APS that allows users to change their password. SmCPW recognizes
## a number of arguments in its URL:
##
##      Target=<target>
##              This argument tells SmCPW where to send the user once
##              the password change is complete. The Target, if 
##              "<Target>" is not used, should be URL-encoded.
##      CancelTo=<URL>
##              This argument tells SmCPW where to send the user if
##              the user presses the CANCEL button. Under some 
##              circumstances, a cancel button will only be displayed
##              if this argument is supplied. If not supplied, Target
##              may be used if a cancel button appears. The URL
##              should be URL-encoded.
##      DaysLeft=<DaysLeft>
##              If the password is going to expire (Password Warning),
##              this will specify the number of days left before the
##              password actually expires. SmCPW may display this
##              value, if specified.
##      GraceLogins=<GraceLeft>
##              This setting tells SmCPW how many grace logins remain,
##              once the password has expired. SmCPW may display this
##              value, if specified.
##      DaysRemaining=<days>
##              This setting tells SmCPW how many days remain after
##              the password has expired until the Grace period has
##              expired as well (and the user will be disabled).
##      Optional
##              This tells SmCPW that the password change is optional
##              and a cancel button should be displayed (CancelTo
##              specifies the same, along with a target URL).
##      Upper   Deprecated - Do not use
##      Lower   Deprecated - Do not use
##
## Multiple arguments should be separated by an ampersand ("&"), thus
## a warning redirect might be:
##
##  /CPS/SmCPW.exe?DaysLeft=<DaysLeft>&Target=<Target>
##
## Additional arguments (either from keys or hard-coded) may be 
## supplied. SmCPW will ignore them, but will pass them on to its own
## target in the same manner.
#######################################################################

##REDIRECTS##

///////////////////////////////////////////////////////////////////////
// When the user reaches "Max Failures" consecutive failures, where
// do we send the user? This must be an *unprotected page*, since the
// user will not be allowed to login. It is not recommended that
// this redirect be used (use the mail notification instead), since
// by using it, your site acknowledges that a valid user id has
// been discovered and thus you open yourself to a regular denial
// of service attack for this user.
///////////////////////////////////////////////////////////////////////

;;Failure Redirect=<UNPROTECTED_PATH>Failure.htm

///////////////////////////////////////////////////////////////////////
// If a user is already disabled when a login attempt occurs, APS
// will send the user to the page listed below. This must be an 
// *unprotected page*, since the user will not be allowed to login. 
// This redirect should not be used for the same reasons as stated
// for the "Failure Redirect" setting. Use the equivalent mail setting
// if you can.
//
// Note that this functionality only works with APS disable 
// functionality. APS has no knowledge of the PS disable flag and 
// SiteMinder will not "tell" APS that the authentication failed 
// because the PS disable flag is set.
//
// A special macro, called DisabledReason, is available in this context
// that contains a list of all of the reasons that the user is 
// disabled. Such a page can then parse out the reasons and display
// them to the user.
///////////////////////////////////////////////////////////////////////

;;Disabled Redirect=<UNPROTECTED_PATH>Disabled.htm?Reason=<DisabledReason>

///////////////////////////////////////////////////////////////////////
// If the user is being warned that his password will expire (starting
// "Expiration Warning" days before "Password Expiration"), where
// should we redirect the user? This should be a protected page 
// (probably the change password page, SmCPW). 
//
// In this context, the DaysLeft macro contains the number of full days 
// until the password actually expires. Note that DaysLeft may be 
// zero, indicating that the password will expire in less than a day.
///////////////////////////////////////////////////////////////////////

Warning Redirect=<CPW_PATH>?Target=<Target>&DaysLeft=<DaysLeft>

///////////////////////////////////////////////////////////////////////
// If a user has not changed his password for "Password Expiration" 
// days, but there is still "Expiration Grace" or "Grace Logins" left,
// where should we redirect the user to force him to change his 
// password? This must be a protected page, since the user will be
// authenticated and will be allowed to change his password.
//
// Additional macros are available in this context:
//  GraceLogins contains the number of remaining grace logins for this
//  user.
//  DaysRemaining contains the number of days left in the Expiration
//  Grace period. 
// SmCPW will use these values to display info to the user.
///////////////////////////////////////////////////////////////////////

Expire Change Redirect=<CPW_PATH>?Target=<Target>&GraceLogins=<GraceLogins>&DaysRemaining=<DaysRemaining>

///////////////////////////////////////////////////////////////////////
// If a user has not changed his password for "Password Expiration"
// plus "Expiration Grace" days, and there are no "Grace Logins" left, 
// where should we redirect the user (after disabling him)? This must 
// be an *unprotected page(, since the user will not be allowed to 
// login. 
///////////////////////////////////////////////////////////////////////

Expired Redirect=<UNPROTECTED_PATH>PasswordExpired.htm

///////////////////////////////////////////////////////////////////////
// If a user is required to change his password immediately (either
// because the force password change flag is set or Auto Force Change
// is in effect), where should we redirect the user? This should
// be a protected page (probably the change password page, SmCPW).
// This change is usually not optional.
///////////////////////////////////////////////////////////////////////

Force Change Redirect=<CPW_PATH>?Target=<Target>

///////////////////////////////////////////////////////////////////////
// If a user has not logged in for "Max Inactive" days, where
// should we redirect the user (after disabling him)? This must be an 
// unprotected page, since the user will not be allowed to login. 
//
// This redirection will only happen when the user successfully
// authenticates and is immediately expired. Thus using this 
// redirection is not a security problem.
//
// If the user then tries again, they will already be disabled and will
// not fire this event again.
//
// If your site uses the real-time user expiration utility (APSExpire), 
// users will probably never see this page, since they will already be 
// disabled when they attempt to authenticate.
///////////////////////////////////////////////////////////////////////

Inactive Redirect=<UNPROTECTED_PATH>Inactive.htm

#######################################################################
## The following should be considered "pseudo-events", in that they are
## not true APS events, but APS can detect them and process them. Note
## that all are processed *after* normal APS events have been handled.
#######################################################################

///////////////////////////////////////////////////////////////////////
// The Generational Redirect settings are used to define a page that
// some or all users should see. APS keeps track of which *version* of
// a page that the user has seen. If that user has not *seen* that
// version, APS will send the user to the page and update the version
// (generation) in the user's record.
//
// Generational Redirect may be overridden on a per user basis, so 
// that it is easy to set up "Employee Only" or "Customer Only" pages.
//
// Multiple Generational Redirect settings can be defined. APS will
// process ALL redirects that apply, in the order in which they appear
// in this file.
//
// Each setting is in the form:
//
//  Generational Redirect={<optional override} <Key>=<version> <URL>
//
// Where <optional override> defines the user subset to which this
// setting applies. 
//
// The <Key> identifies the Generational Redirect. It can be any
// text, but cannot contain a space or equal sign. Values for <Key>
// are *not* case-sensitive.
//
// The <version> value defines which version of the key is current. It
// must be a numeric value.
// 
// The <URL> defines where the user should be redirected.
//
// If the URL changes, or existing users should see the URL again,
// update <version> to a higher number. Upon the next login, anybody
// that has only seen a lower version number will be directed to the
// URL again.
//
// The same <Key> can appear more than once for the same group of 
// people, though no decent examples as to why a site would do that
// come to mind.
//
// Examples:
// ---------
//
// To force users to see an Online Access Agreement (License) the first
// time that they login, use something like:
//
//      Generational Redirect=LICENSE=1 /license.htm
//
// If the site wants the user to update their profile the first time
// that each user logs in, use:
//
//      Generational Redirect=PROFILE=1 /profile.jsp
//
// If the site wants all users to check their profile at their next
// login, update the version number in the previous example to "2".
//
// By setting *both* of the previous examples (in that order), each
// user will see the License Agreement, then the Profile form, on their
// first login.
///////////////////////////////////////////////////////////////////////

##GENERATIONAL REDIRECTS##

;;Generational Redirect=LICENSE=1 <LICENSE_URL>
;;Generational Redirect=PROFILE=1 <PROFILE_URL>

///////////////////////////////////////////////////////////////////////
// MOTD (message of the day) allows a site to send a user to a specific
// page the first time that the user authenticates *each day*. The user
// will only be redirected here once per day. It uses the Generational
// Redirect capability to track whether a user has seen the daily 
// message yet today.
//
// Different messages can be presented to different users by specifying
// overrides on the setting.
//
// "Always Redirect" will cause the user to be sent to the specified
// page after authentication (every time, when no other event occurs).
// Normally, this setting should be turned off. It is useful, however,
// to force users to see reminders or to check something (like email?)
// every time that the user logs in.
//
// "Always Redirect AZ" will redirect the user to the specified page
// every time they try to access *any* page. This effective prevents 
// access to all or part of the site. This setting is normally not
// used, but can be very helpful during phased rollouts and during 
// testing (especially used with overrides). To prevent infinite loops,
// either redirect to an unprotected page or use Context Macros so 
// that Redirection only occurs within specific realms.
//
// Examples:
//      If Application "B" is being rolled out on Saturday, starting on
//      Monday, these settings might contain (assume that the page
//      contains the warning that the site will be unavailable on
//      Saturday):
//
//          MOTD=/SaturdayWarning.htm
//          ;;Always Redirect=
//          ;;Always Redirect AZ=
//
//      Users will see the warning only the first time that they log
//      in each day.
//
//      On Friday, the warning should be issued more often as a 
//      reminder:
//
//          ;;MOTD=
//          Always Redirect=/SaturdayWarning.htm
//          ;;Always Redirect AZ=
//
//      Now, *every* time that the user logs in, the user will see the
//      warning.
//
//      On Saturday, the following settings would be used:
//
//          ;;MOTD=
//          ;;Always Redirect=
//          Always Redirect AZ={NOT @Tester AND %App="B"}/SaturdayWarning.htm
//
//      Every user that is not a tester that tries to access that part
//      of the site that passes "APP=B" through AZRedirect will be sent
//      to this page instead of allowed to access the application.
//
// This entire process can be set up with minimal effort on Monday as:
//
//          define ROLLOUT_PHASE        PHASE1
//
//          MOTD={"<ROLLOUT_PHASE>"="PHASE1"}/SaturdayWarning.htm
//          Always Redirect={"<ROLLOUT_PHASE>"="PHASE2"}/SaturdayWarning.htm
//          Always Redirect AZ={("<ROLLOUT_PHASE>"="PHASE3") AND NOT @Tester AND %App="B"}/SaturdayWarning.htm
//
// Then only the DEFINE needs to change from PHASE1 to PHASE2 to 
// PHASE3. Note the quotes around <ROLLOUT_PHASE> within the overrides.
// These are required to ensure that the evaluator doesn't consider the
// phase as an attribute name.
///////////////////////////////////////////////////////////////////////

;;MOTD=<MOTD>

;;Always Redirect={false}
;;Always Redirect AZ={NOT @Tester AND %App="NewApp"} /Sorry.htm

#######################################################################
## Mail Files
##
## These files are sent when the specified event occurs. These settings
## can be overridden. There is no such thing as "more restrictive" in 
## this case; the LAST applicable setting will be used.
##
## File names may contain full or relative paths or no path at all. 
## APS will use the Mail Directory setting to locate files, if 
## required.
##
## File names may contain attribute replacement specifications,
## such as "/Mail/{preferredLanguage}/Disabled.email".
##
## Multiple files may be specified. If so, APS will send all of them,
## if possible. This is useful when one file should be sent to the user
## and another to an administrator.
##
## The format of these files is described in the APS manual.
##
## If no mail is to be sent for a specific event, comment out or
## leave the setting blank.
##
## In each context, the same macros that are available for redirects
## may be referenced in the mail file.
##
## Some sites find it useful that APSExpire sets a macro called 
## APSEXPIRE to "YES" during execution. This macro can be tested so 
## that different mail templates can be used by APSExpire.
#######################################################################

##MAIL FILES##

///////////////////////////////////////////////////////////////////////
// Sent when a disabled user tries to authenticate. Useful to tell the
// user that they have entered correct information, but the user 
// record is currently disabled. Note that if passwords are reset
// (see the "Reset Passwords" setting) users will fail authentication
// and not see this mail. This is only sent when they successfully
// authenticate, then are rejected because they are in a disabled 
// state.
//
// The "DisabledReason" macro is available in this context.
///////////////////////////////////////////////////////////////////////

Disabled User Mail=Disabled.email

///////////////////////////////////////////////////////////////////////
// Sent when the maximum failure count is exceeded and the user is
// not going to be allowed to login. A very secure way to notify a
// user (or administrator) of a POSSIBLE attack on the system, since
// a hacker will not receive the mail (and thus the user id is not
// confirmed and the hacker will continue attemps that can never 
// succeed), but the user knows why his mistaken logins do not work
// and that his account is disabled.
// 
// Administrators can be notified of an attack. This is often VERY
// usefully overridden for Administrator accounts, since it can be
// used to notify system or security administrators of attempts to
// access the system (most sites will not want System Administrator
// notification for all Max Failure events, only attacks on 
// administrator accounts).
// 
// This mail is only sent when the Max Failure Count is initially 
// reached.
///////////////////////////////////////////////////////////////////////

Max Failures Mail=MaxFailures.email

///////////////////////////////////////////////////////////////////////
// If further attacks take place on an Account, APS can continue to 
// send mail using this setting. Mail will be sent each "Max Failures"
// that occur. For example, if Max Failures is set to 5, the 
// "Max Failures Mail" will be sent when 5 failures have occurred,
// the "Ongoing Failures Mail" will be sent at 10 failures, etc.
//
// Typically, this mail is sent to a site administrator through an SMTP
// pager gateway so that the administrator can receive real-time
// notification of an attack.
///////////////////////////////////////////////////////////////////////

;;Ongoing Failures Mail=OngoingFailures.email

///////////////////////////////////////////////////////////////////////
// If the user is disabled because he is inactive, this setting is used
// to find the file to send as mail. This setting is ONLY used during
// the authentication process, not by APSExpire.
///////////////////////////////////////////////////////////////////////

Inactive User Mail=InactiveUsers.email

///////////////////////////////////////////////////////////////////////
// This setting controls the mail file sent when a user's password
// expires. This is sent when the user gets disabled because of
// password expiration. This setting can be used by APSExpire.
//
// There are two macros available:
//      AsOf contains the actual date that the password expired.
//      DaysSinceExpiration contains the number of days since the
//      password expired.
///////////////////////////////////////////////////////////////////////

Expired Password Mail=ExpiredPassword.email

///////////////////////////////////////////////////////////////////////
// If the user will be forced to change his password, this mail will
// be sent. Not very useful. Also sent once the password "soft"
// expiration has passed, but there is a grace period.
//
// Three macros are available in this context:
//      AsOf contains the date that the password expired (if 
//      applicable).
//      DaysRemaining contains the number of days that they have to 
//      change their password (if applicable)
//      DaysSinceExpiration contains the number of days since the
//      password expired (if applicable).
///////////////////////////////////////////////////////////////////////

Force Change Mail=ForceChangePassword.email

///////////////////////////////////////////////////////////////////////
// If the user must be warned that his password will expire, but does
// not yet have to change his password, this mail is sent. The
// DaysLeft macro is defined in this context and can be used to tell
// the user, in the body of the mail, how many days are left.
// The Asof macro contains the date that the password will expire.
///////////////////////////////////////////////////////////////////////

Password Warning Mail=PasswordWarning.email

///////////////////////////////////////////////////////////////////////
// The real-time user expiration utility (APSExpire) uses this setting 
// to determine the mail file to send to warn a user that his account 
// WILL expire. This setting is *only* used by APSExpire.
//
// There are two macros available:
//      AsOf contains the date that the account will expire.
//      DaysLeft contains the number of days before the account will
//      expire.
///////////////////////////////////////////////////////////////////////

Inactivity Warning Mail=InactivityWarning.email

///////////////////////////////////////////////////////////////////////
// The real-time user expiration utility (APSExpire) uses this setting 
// to determine the mail file to send when it disables user due to 
// inactivity. This is often the same file as Inactive User Mail 
// setting above. This setting is *only* used by APSExpire.
//
// The AsOf macro, containing the date that the account will expire,
// is available in this context.
///////////////////////////////////////////////////////////////////////

Inactivity Disabled Mail=InactivityDisabled.email

///////////////////////////////////////////////////////////////////////
// This setting is used when a user changes his own password. It is not
// often used.
///////////////////////////////////////////////////////////////////////

Change Confirmation Mail=ChangeConfirmation.email

#######################################################################
## Settings for SMTP Mail
##
## Only SMTP mail is supported. Early versions of APS supported 
## Microsoft Exchange natively, but there are technical reasons that
## caused us to abandon that support.
##
## The Mail section starts with the section identifier. Once sections 
## have been started, no "generic" settings can be specified.
##
## Only the DIRECTORY keyword supports overrides.
#######################################################################

[Mail]

///////////////////////////////////////////////////////////////////////
// The name or IP address of the SMTP server. If not set,
// no mail will ever be sent. While this setting cannot be overridden, 
// it is a useful target for a DEFINE macro.
// 
// This setting is not deprecated, but may be specified in the email
// template files themselves (see the APSMail documentation), which is
// preferred.
///////////////////////////////////////////////////////////////////////

<NO_MAIL>Server=<SMTP_SERVER>

///////////////////////////////////////////////////////////////////////
// The name of a log file where ALL mail will be logged (even if a mail
// server is not specified). Useful for debugging. 
//
// The information logged includes any status codes returned by the
// mail server.
///////////////////////////////////////////////////////////////////////

Log Path=<MAIL_LOG>

///////////////////////////////////////////////////////////////////////
// The Directory setting is similar to the PATH environment variable;
// it can contain one or more directories on which mail files can 
// reside. Directories will have attribute translation performed on 
// them. Multiple directories are separated by semicolons on Windows, 
// colons on Unix.
//
// This setting can support overrides. This is useful when multiple
// sets of email files exist and different ones should be used, 
// depending on user properties.
///////////////////////////////////////////////////////////////////////

Directory=<MAIL_PATH>

#######################################################################
## The Logging section contains keyword/value pairs to be passed to the
## custom APS logging library called SmAPSLog. Allowed values for this
## section are dependent on the version of SmAPSLog (if any) installed
## at your site.
##
## These settings do *not* support any sort of override.
#######################################################################

[Logging]

///////////////////////////////////////////////////////////////////////
// The version of SmAPSLog delivered with APS (and also supplied in
// source code) writes log values to a flat file. A single setting is
// supported that is used to specify the path of the file. If no file
// is specified, no logging will occur.
///////////////////////////////////////////////////////////////////////

;;Audit File=SmAPS.log

#######################################################################
## The Custom section contains keyword/value pairs to be passed to the
## custom APS extension library called SmAPSEx. Allowed values for this
## section are dependent on the version of SmAPSEx (if any) installed
## at your site.
##
## These settings do *not* support any sort of override.
#######################################################################

[Custom]

#######################################################################
## The Dictionary section indicates that from this point down, all 
## entries are disallowed words (all comparisons are case-insensitive
## and checked both forwards and backwards). Comments and blank lines
## ARE allowed in this section. Note that words less than 4 characters
## will be ignored.
##
## These settings do *not* support overrides.
##
## We recomment that "PASSWORD" be disallowed, but have received 
## complaints from sites for putting it into the default list. 
## Uncomment at your discretion.
#######################################################################

[Dictionary]

;;PASSWORD
BASEBALL
ACCOUNT
CUSTOMER
LDAP
ADMIN
WINDOWS

#######################################################################
## The Complexity section allows a site to change the parameters used
## to calculate password complexity. Typically, the default settings
## are suitable, but a site may tune the values in this section. Note
## that while overrides are supported for the Complexity Threshold 
## (as part of content control), overrides are NOT supported for the
## parameters below. 
##
## Please see the APS manual for the specific settings allowed in this 
## section.
##
## The APSTestSettings and APSComplexity utilities (supplied with APS)
## are useful when tuning complexity settings.
#######################################################################

[Complexity]

#######################################################################
## This section is used to define attribute mappings. This is done to
## separate the names of the LDAP attributes and ODBC columns from
## their references in code.
##
## These settings support overrides and, in a multiple directory 
## environment, they are essentially required for proper operation.
## HOWEVER, they must be used with care, since mappings can be used
## in overrides, any override that references an attribute might not
## be evaluated correctly. Typically, the overrides are like:
##
##      userPassword={IsLDAP()}userPassword
##      userPassword={IsODBC()}password
##
##  or
##
##      Name={IsLDAP()}cn
##      Name={IsODBC()}FullName
##
## Attempts to use user-specific references in the mappings section
## will result in an error. User-specific references include 
## references to attributes, the IsInGroup(), IsNull(), IsNew() and
## all of the DN-related functions (IsAt, etc.).
##
## The general format for a mapping setting is:
##
##      <external name>=<name in directory>
##
## The External Name is the one to use in overrides, attribute names
## in replacement values, and is used internally by APS.
##
## If an external name is referenced, but not mapped in this section,
## the raw name will be used.
##
## If the name appears with no value, there is no underlying storage.
## For most uses, this amounts to a NULL value. For those attributes
## that are *required* (such as smapsLastLogin), the null remapping is 
## ignored and the external name is used. 
##
## In this way, certain audit data maintained by APS by default can
## be surpressed, such as:
##
##      smapsLoginHistory={IsLDAP()}
##
## Since there is no underlying attribute, it will not be stored.
##
## There are no specific settings here, since any attribute name can
## be mapped for overrides and replacement parameters. However, there
## are a number of attributes that are referenced by APS internally.
## See the APS documentation for those values.
##
## If multiple settings apply, the last one is used.
##
## External names are never case-sensitive. Internal names have their
## case preserved when requesting them from the underlying directory.
##
## LDAP reverse groups are also identified in this section using an
## external name of "LDAP.ReverseGroups" (note the dot after "LDAP").
## This keyword is followed by an equal sign and optional override,
## then by the FULL DN of the group that is a reverse group.
##
## If the DN of the reverse group is "*" (without quotes), then all
## groups will be reverse groups.
##
## For any given group, all LDAP.ReverseGroup settings will be checked
## to determine if the group is a reverse group.
##
## For LDAP Reverse Groups, APS assumes that the DN of the group is
## stored in the user's entry in an attribute called "memberof". If
## a different attribute is to be used, it must be remapped in this
## section.
##
## For APSAdmin, entire group DNs must be remapped in order to give 
## them valid attribute names. These remapped names for groups is ONLY
## used by APSAdmin.
#######################################################################

[Mappings]

## The following three lines MUST be used (modified accordingly) if 
## Microsoft's Active Directory is to be used as a User Directory. The
## value of <dirname> must be replaced by the *name* of the User
## Directory entry in the SiteMinder Policy Store. If ONLY Active
## Directory is used, then the entire override can be safely removed.
##
## If userPassword is not remapped to unicodePwd, APS will not detect 
## that a particular directory is an Active Directory and will not
## perform the special processing required for Active Directory.

;;inetOrgPerson={ IsInDirectory("<dirname>") } user
;;userPassword={ IsInDirectory("<dirname>") } unicodePwd
;;smapsPassword ={ IsInDirectory("<dirname>") }

Name={IsLDAP()}cn
Name={IsODBC()}Name

FirstName={IsODBC()}FirstName
FirstName={IsLDAP()}givenname

LastName={IsODBC()}LastName
LastName={IsLDAP()}sn

Disabled_FailureCount={IsLDAP()} cn=Disabled-FailureCount,o=nds.com
Disabled_Password={IsLDAP()} cn=Disabled-PasswordExpired,o=nds.com

#######################################################################
## The APSAdmin section is used to define the data and operations 
## available through the APSAdmin API (and thus to the APSAdmin 
## utility).
#######################################################################

[APSAdmin]

///////////////////////////////////////////////////////////////////////
// The Allowed keyword can appear anywhere in this section, but, for
// readability, should be placed at the top of the section.
//
// This keyword defines whether APSAdmin can be used by which 
// administrators against which users. To control a specific 
// administrator or group of administrators, use standard override
// syntax on the keyword.
//
// The *value* of each setting is also an override expression, but it
// will be applied to the "target" user rather than to the requesting
// administrator. For example, to allow all users to administer only
// users whose first name starts with "E", use:
//
//      Allowed=FirstName ~STARTS_WITH "E"
//
// Or, to restrict it to administrators:
//
//      Allowed={@Administrators} FirstName ~STARTS_WITH "E"
//
// A special function is available for these settings only called 
// Self(). This function is TRUE if the target user is the same as
// the requesting user. Thus, the following setting allows people
// to administer themselves only.
//
//      Allowed=Self()
//
// Values of "TRUE" and "FALSE" are also allowed, if the setting is
// really independent of the user, so, for example, to allow 
// administrators access to all users:
//
//      Allowed=TRUE
//
// Or, to allow access to all users except themselves:
//
//      Allowed=Not Self()
//
// The Allowed keyword can appear more than once. Each applicable 
// setting (according to overrides) will be checked. If *any* setting
// allows access for the current administrator, then the administrator 
// will be allowed access. If no access is allowed, an ACCESS DENIED
// error will be returned.
///////////////////////////////////////////////////////////////////////

Allowed=<ALLOW_APSADMIN>

///////////////////////////////////////////////////////////////////////
// The APSAdmin API function and utility can allow password changes 
// without requiring the old password (this is for help desk 
// administrative password resets).
//
// The Validate Password setting controls whether a changed password
// will be checked against password policies. Like the Allowed setting
// above, the setting value is another expression.
//
// Even if Validate Password is specified, only the basic password
// policies are checked. The user attributes and password history are
// never checked (since it is presumed that the administrator does
// not know these values).
//
// By default, all passwords are validated.
///////////////////////////////////////////////////////////////////////

Validate Password=true

///////////////////////////////////////////////////////////////////////
// The APSAdmin API function and utility can allow password changes 
// without requiring the old password (this is for help desk 
// administrative password resets).
//
// The Force Immediate Change setting controls whether APSAdmin (the
// API) should set smapsImmediateChange when a password is reset.
// If ANY applicable value is TRUE, the immediate change flag will
// be set.
//
// One exception: if, on the same update, smapsImmediateChange is
// explicitly updated, APSAdmin will not update the flag 
// automatically, regardless of this setting.
///////////////////////////////////////////////////////////////////////

Force Immediate Change=true

///////////////////////////////////////////////////////////////////////
// Also in this APSAdmin section are the definitions of the attributes 
// and sections that an administrative request can access.
//
// The sequence that these settings appear is *VERY SIGNIFICANT*.
//
// The most basic setting in this section is in the form of:
//
// <access>.<attribute>={<administrator selection>} <target expression> [PROMPT <prompt>]
//      or
// <access>.GROUP.<group>={<administrator selection>} <target expression> [PROMPT <prompt>]
// 
// Where <access> can be "READ", "WRITE" or "RW" (for read/write).
// <attribute> is a (usually remapped) attribute name. <group> is a
// (almost always remapped) group name (it cannot contain equal signs).
//
// The <administration selection> is optional and overrides the
// setting so that it only applies to certain administrators. Note that
// a special context macro exists called "APSAdmin" that has a value of
// "YES" when the APSAdmin utility is requesting data.
//
// The <target expression> uses the override syntax to define if this
// setting applies for the *target user* (as opposed to the requesting
// administrator). A special function is available in this context 
// called Self(), which is true if the target is the same as the 
// requesting administrator.
//
// If the <target expression> is true, then the setting applies (if it
// applies for the requesting administrator).
//
// An administrator must explicitly be granted rights to access the
// attribute or group.
//
// If multiple settings apply, only the FIRST setting for a given
// attribute or group is used when data is requested. Thus, if the
// following two settings appear (in this order):
//
//      READ.Name={@Administrator} TRUE
//      WRITE.Name={@Administrator} TRUE
//
// Then the name will be returned upon request, but the response will
// indicate that the field is read-only (since the first applicable
// setting is marked READ). However, if the requester then sends an
// update anyway, the write will be allowed, since the second setting
// allows updates. While this seems to be a little strange, there are
// a few odd scenarios where it is useful.
//
// The PROMPT clause is entirely optional and controls the prompt
// to be sent to the requestor for that setting. The APSAdmin utility
// will use the attribute or group name if the prompt is not specified.
// The APSAdmin utility will also recognize prompts that start with
// "#" as translation keys. If a prompt is supplied that starts with
// "#", the APSAdmin program will look up the value (with the "#") in
// the APSAdmin.lang file. It will use a default of the lookup value
// with the "#" removed.
//
// Attribute and Group settings can be grouped together into Sections.
// The use of sections is entirely optional. The APSAdmin utility will
// display settings grouped into the defined Sections, with a heading
// that corresponds to the Section's prompt. If no prompt is defined,
// for the section, the APSAdmin utility will display a horizontal 
// line.
//
// Sections are defined using the syntax:
//
//      Section=<section name> [PROMPT <section prompt>]
//
// The section name will be used as the prompt if no prompt is 
// specified. Standard rules about prompt translation (using "#" as
// discussed above) will be used.
//
// Once sections have been started, you cannot return to unsectioned
// values.
//
// Sections cannot be nested.
//
// If a section is defined, but contains no attribute or group 
// definitions, it will not be returned. In other words, to suppress
// an entire section in a specific context, ensure that all of its
// contained settings are supressed.
//
// The APSAdmin utility knows how to handle groups, disabled groups,
// and certain specific APS operational attributes that it identifies
// by name. See the APS manual for complete details.
// Some APS operational attributes have restrictions on writing.
///////////////////////////////////////////////////////////////////////

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; This first section is used to fully identify the user. For help-
;; desk style apps, this is important to verify the user on the phone.
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

Section=User Identification
READ.Name=true
READ.LastName=true [PROMPT Last Name].
READ.FirstName=true [PROMPT First Name]

;; Change the next line from "READ" to "RW" to allow changing the 
;; user's email address.

READ.mail=true [PROMPT Email Address]

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; This Base Information section is not all that useful. It displays
;; APS operational information that, in general, should not be changed
;; without considering the consequences.
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

Section=Base Information
RW.smapsBaseDate=true [PROMPT Base Date]
READ.smapsNextAction=true [PROMPT Next Action]

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; These settings show the per-user overrides for password and account
;; expiration. For performance reasons, these settings should be used
;; as sparingly as possible.
;;
;; The examples below will only allow help desk managers to read/write
;; these settings. Normal Help Desk users will only see them if they
;; are not null.
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

Section=Per User Overrides
READ.smapsExpirePasswordDays={@HelpDesk AND NOT @HelpDeskManager} Not IsNull("smapsExpirePasswordDays") [PROMPT Expiration]
RW.smapsExpirePasswordDays={@HelpDeskManager} true [PROMPT Expiration]

READ.smapsAccountInactivityDays={@HelpDesk AND NOT @HelpDeskManager} Not IsNull("smapsAccountInactivityDays") [PROMPT Account Inactivity]
RW.smapsAccountInactivityDays={@HelpDeskManager} true [PROMPT Account Inactivity]

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; This section shows information about the target user's logins
;; Auditing attributes are always READ ONLY to the APSAdmin utility.
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

Section=Login Information
READ.smapsLastLogin=true [PROMPT Last]
READ.smapsFailuresSinceLastLogin=true [PROMPT Failures Since]
READ.smapsPreviousLogin=true [PROMPT Previous]
READ.smapsFailuresSincePreviousLogin=true [PROMPT Failures Since]
RW.smapsFailureCount=true [PROMPT Failure Count]
RW.smapsRealmBasedFailureCount=true [PROMPT Realm Based Failure Count]
READ.smapsGraceLoginsUsed=true [PROMPT Grace Logins Used]
READ.smapsMaxFailures=true [PROMPT Max Failures]
READ.smapsTotalLogins=true [PROMPT Total Logins]
READ.smapsTotalFailures=true [PROMPT Total Failures]

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; This section defines how a user is disabled. Note that not all
;; possible disable possibilities may be presented and not all have to
;; be read/write. It is often useful to create a "hierarchy" of 
;; administrators, for example:
;;
;;      RW.GROUP.Disabled_FailureCount=true 
;;      READ.GROUP.Disabled_Manual={@HelpDesk AND NOT @HelpDeskManager} true
;;      RW.GROUP.Disabled_Manual={@HelpDeskManager} true
;;      READ.GROUP.CreditLimit=true
;;
;; Another example is to allow the RESET of DisableUntil, but not 
;; allow setting it. These lines will allow it to be changed, but not
;; changed from null to a value.
;;
;;      RW.smapsDisableUntil=Not IsNull("smapsDisableUntil")
;;      READ.smapsDisableUntil=IsNull("smapsDisableUntil")
;;
;; (note that the attribute name must be quoted for the IsNull 
;; function)
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

Section=Disabling Information
RW.smapsDisableUntil=true [PROMPT Disabled Until]
RW.smapsDisableAfter=true [PROMPT Disabled After]
RW.smapsMustLoginBy=true [PROMPT Must Login By]
RW.GROUP.Disabled_FailureCount=true [PROMPT Disabled due to Failure Count]
READ.GROUP.Disabled_Password={@HelpDesk AND NOT @HelpDeskManager}true [PROMPT Password Expired]
RW.GROUP.Disabled_Password={@HelpDeskManager}true [PROMPT Password Expired]

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; This section shows Generational Redirect info. The APSAdmin utility
;; only allows the reset of specific keys.
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

Section=Generational Redirects
RW.smapsGenerationalRedirects=true [PROMPT Generational Redirects]

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; This section shows information about password changes.
;;
;; Note that there is EXTRA special processing for userPassword.
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

Section=Password Change Information
RW.smapsImmediateChange=true [PROMPT Immediate Change]
RW.smapsLastPasswordChange=true [PROMPT Last Changed]
RW.userPassword=true [PROMPT Change Password]

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; A section for displaying the user's login history. When this 
;; attribute is writable, it can only be cleared.
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

Section=Login History
RW.smapsLoginHistory=true [PROMPT Login History]

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; A section for displaying the user's FPS use information.
;; smfpsLog, if writable, can only be cleared.
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

Section=Forgotten Password
RW.smfpsLockoutCounter=true [PROMPT Lockout Counter]
RW.smfpsLog=true [PROMPT Audit Log]

#######################################################################
## The APSExpire section controls the operation of the APSExpire 
## utility, which is a batch (WinAt, cron, etc.) job that processes APS
## events in real-time.
##
## In this section, a site defines "jobs" by name. Each setting is the
## name of a job and the values define the criteria for the job. When
## APSExpire is executed, a job name is specified. The program will 
## look for the definition of this job in this section of the file.
##
## Subsequent definitions for a job already defined will be ignored.
##
## There are no overrides in this section, since jobs do not apply to
## a user.
##
## Each "job" defines a user directory or subset of a user directory.
## The syntax for ODBC and LDAP directories are different.
##
## FOR LDAP DIRECTORIES, the syntax is:
## ====================================
##
##  <job name>=<LDAP directory> READ(<ip>) BASE(<base DN>) SCOPE(<scope>) FILTER(<filter>)
##
## Where <job name> is an arbitrary name for the job.
##
## <LDAP directory> is the ip address, the network name, or
## the SiteMinder User Directory name of an LDAP directory defined to
## SiteMinder through the Policy Interface. If it is an ip address, 
## it may contain the port address as well. This *must* match up with 
## the definition of a User Directory in the SiteMinder Policy Store 
## (APSExpire will attempt to look up the directory using this value).
##
## "READ(<ip>)" is an optional clause that tells APSExpire to read
## from a different directory than the base directory. In some cases,
## much higher performance can be achieved by reading from a dedicated
## replicant directory that either SiteMinder does not use at all or
## is the last directory in a failover chain. If specified, however,
## the alternate directory *must* be a replicant of the "real" 
## directory.
##
## "BASE(<search Base>)" defines the scope of the search. It is 
## entire optional. If not specified, APSExpire will search the entire
## directory using the search base defined in the SiteMinder User
## directory entry. This is useful when an entire LDAP directory is
## NOT to be processed as a single job. Sites do this when the LDAP
## directory is very large and APSExpire processing is to be spread
## over multiple servers or jobs.
##
## "SCOPE(<scope>)" is optional and is generally used with the
## BASE option above. <scope> can either be "base" or "sub" (without
## quotes). It specifies how the LDAP search should be processed.
##
## "FILTER(<extra filter>)" is another optional setting that allows
## a site to further refine a job. This filter is ANDed with any
## filters that APSExpire uses for its own operations. Once again,
## this is intended to segregate an LDAP directory into smaller
## jobs for performance reasons. 
##
## When using BASE, SCOPE and FILTER, it is the responsibility of
## the site to make sure that every user will be processed. APSExpire
## does not examine the sum of all defined jobs to ensure that all
## users get processed.
##
## FOR ODBC DIRECTORIES, the syntax is:
## ====================================
##
##  <job name>=<ODBC directory> WHERE(<extra WHERE clause>)
##
## Where <job name> is an arbitrary name for the job.
##
## <ODBC directory> is the DSN name or the SiteMinder User Directory 
## name of an ODBC user directory defined to SiteMinder through the 
## Policy Interface. This *must* match up with the definition of a 
## User Directory in the SiteMinder Policy Store  (APSExpire will 
## attempt to look up the directory using this value).
##
## "WHERE(<extra WHERE clause>)" is another optional setting that 
## allows a site to further refine a job. This clause is ANDed with 
## any WHERE clause that APSExpire uses for its own operations. This 
## is intended to segregate an ODBC directory into smaller jobs for 
## performance purposes. 
##
## When using WHERE, it is the responsibility of the site to make sure 
## that every user will be processed. APSExpire does not examine the 
## sum of all defined jobs to ensure that all users get processed.
#######################################################################

[APSExpire]

;;JOBONE=127.0.0.1

#######################################################################
## The ODBC section defines the ODBC queries that APS may need to 
## access users and groups stored in an RDBMS.
##
## Wherever possible, APS uses the queries defined in the ODBC Query
## Scheme stored in the SiteMinder Policy Store and associated with the
## ODBC Directory.
##
## That said, all of the queries in the ODBC Query Scheme can be 
## overridden here for use by APS/FPS.
##
## There are some APS-specific queries here that must be defined (they
## do not exist in the SiteMinder ODBC Query Scheme).
##
## Each query will have replacement parameters (identified as "%s")
## that APS will replace with the proper value at run-time. See the
## specific setting to determine the values and order of the 
## replacement parameters for that query.
##
## If no ODBC user directory is to be used, then this section is
## ignored.
##
## These settings *cannot* be overridden on a per user or per 
## directory basis.
#######################################################################

[ODBC]

///////////////////////////////////////////////////////////////////////
// The AutoCommit setting is not an ODBC query. It tells APS to use
// AutoCommit semantics instead of explicit commits. CA Technologies does
// NOT recomment the use of AutoCommit, since multiple updates may be
// made to the underlying directory that should be committed or rolled
// back together. However, this setting can be used to turn AutoCommit
// on (the default is OFF) if needed.
///////////////////////////////////////////////////////////////////////

;;AutoCommit=on

///////////////////////////////////////////////////////////////////////
// The Enumerate query overrides the query by the same name defined to
// SiteMinder. APS does not use this query at this time.
///////////////////////////////////////////////////////////////////////

;;Enumerate=

///////////////////////////////////////////////////////////////////////
// The Get Object Info query overrides the query by the same name 
// defined to SiteMinder. APS does not use this query at this time.
///////////////////////////////////////////////////////////////////////

;;Get Object Info=

///////////////////////////////////////////////////////////////////////
// The Lookup query overrides the query by the same name 
// defined to SiteMinder. APS does not use this query at this time.
///////////////////////////////////////////////////////////////////////

;;Lookup=

///////////////////////////////////////////////////////////////////////
// The Init User query overrides the query by the same name 
// defined to SiteMinder. APS does not use this query at this time.
///////////////////////////////////////////////////////////////////////

;;Init User=

///////////////////////////////////////////////////////////////////////
// The Authenticate User query overrides the query by the same name 
// defined to SiteMinder. APS uses this query to determine if the
// old password entered during a password change is valid. The
// default query is:
//
//  SELECT Name FROM SmUser WHERE Name = '%s' AND Password = '%s'
//
// The first parameter is the user's name (entered to SiteMinder)
// and the second value is the (clear-text) old password as entered
// during the change password process.
//
// This query can be a stored procedure, but the replacement 
// parameters must retain their order and meaning.
///////////////////////////////////////////////////////////////////////

;;Authenticate User=SELECT Name FROM SmUser WHERE Name='%s' AND Password='%s'

///////////////////////////////////////////////////////////////////////
// The Get User Property query overrides the query by the same name 
// defined to SiteMinder. APS uses this query to retrieve the attribute
// values defined for the user. The default query is:
//
//  SELECT %s FROM SmUser WHERE Name = '%s'
//
// The first parameter is *always* an asterisk (retrieve all defined
// columns) the second parameter is the user's id. If all columns 
// should not be returned, this query should be overriden to reference
// a stored view in the database that returns fewer columns. Note that
// only columns returned on this query can be used in overrides or as
// macros.
//
// The first parameter is always replaced as a constant asterisk. A
// query could be defined with this, but then APS could not use the
// query defined to SiteMinder (which contains a replacement parameter
// in this position).
//
// This query can be a stored procedure, but the replacement 
// parameters must retain their order and meaning.
///////////////////////////////////////////////////////////////////////

;;Get User Property=SELECT %s FROM SmUser WHERE Name='%s'

///////////////////////////////////////////////////////////////////////
// The Set User Property query overrides the query by the same name 
// defined to SiteMinder. APS uses this query to set attribute
// values for the user. The default query is:
//
//  UPDATE SmUser SET %s = '%s' WHERE Name = '%s'
//
// The first parameter is the (mapped) name of the attribute (column)
// to set, the second is the value to set it to. The third parameter
// is the user's name.
//
// APS does special processing when using this query. If the query
// defined to APS (or SiteMinder) uses UPDATE, then APS will build
// a query to update ALL columns at once, using standard SQL syntax.
//
// If, however, a stored procedure is used for this query, APS will
// call the stored procedure for each change. Parameters must appear
// in the same order for stored procedured.
//
// The use of the UPDATE query is for higher performance.
//
// If column access is to be restricted, create a stored VIEW in the
// database and use an UPDATE query to the stored view.
///////////////////////////////////////////////////////////////////////

;;Set User Property=UPDATE SmUser SET %s='%s' WHERE Name='%s'

///////////////////////////////////////////////////////////////////////
// The Get User Properties query overrides the query by the same name 
// defined to SiteMinder. APS does not use this query at this time.
///////////////////////////////////////////////////////////////////////

;;Get User Properties=

///////////////////////////////////////////////////////////////////////
// The User Properties setting overrides the setting by the same name 
// defined to SiteMinder. APS does not use this query at this time.
///////////////////////////////////////////////////////////////////////

User Properties

///////////////////////////////////////////////////////////////////////
// The Lookup User query overrides the query by the same name 
// defined to SiteMinder. FPS and APSExpire use this query to locate
// users in the directory. The default query is:
//
//  SELECT Name, 'User' AS Class FROM SmUser WHERE %s
//
// The parameter is the WHERE clause built up by FPS or APSExpire.
///////////////////////////////////////////////////////////////////////

;;Lookup User=SELECT Name, 'User' AS Class FROM SmUser WHERE %s

///////////////////////////////////////////////////////////////////////
// The Get User Groups query overrides the query by the same name 
// defined to SiteMinder. APS uses it to return the list of group in
// which the current user is a member. The default query is:
//
//  SELECT SmGroup.Name FROM SmGroup, SmUser, SmUserGroup 
//                     WHERE SmUser.Name = '%s' AND 
//                           SmUser.UserID = SmUserGroup.UserID AND 
//                           SmGroup.GroupID = SmUserGroup.GroupID
//
// The parameter is the user's name.
// 
// Each row returned represents a group name that the user is a member
// of.
///////////////////////////////////////////////////////////////////////

;;Get User Groups=SELECT SmGroup.Name from SmGroup, SmUser, SmUserGroup WHERE SmUser.Name = '%s' AND SmUser.UserID = SmUserGroup.UserID AND SmGroup.GroupID = SmUserGroup.GroupID

///////////////////////////////////////////////////////////////////////
// The Is Group Member query overrides the query by the same name 
// defined to SiteMinder. APS uses it to determine if the user is in
// a specific group, both for internal purposes and to determine the
// result of IsInGroup() calls in an override expression. The default 
// query is:
//
//  SELECT ID FROM SmUserGroup 
//           WHERE UserID = 
//                  (SELECT UserID FROM SmUser 
//                                WHERE Name = '%s') AND 
//                 GroupID = 
//                  (SELECT GroupID FROM SmGroup 
//                                 WHERE Name = '%s')
//
// The first parameter is the user's name, the second is the name of
// the group of interest.
// 
// If the result of the query contains any rows or data, the user is
// considered a member of the group.
///////////////////////////////////////////////////////////////////////

;;Is Group Member=SELECT ID FROM SmUserGroup WHERE UserID=(SELECT UserID FROM SmUser WHERE Name='%s') AND GroupID in (SELECT GroupID FROM SmGroup WHERE Name like'%s')

///////////////////////////////////////////////////////////////////////
// The SetPassword query overrides the query by the same name 
// defined to SiteMinder. APS uses it to actually change the user's
// password. Typically, it is a stored procedure, but it need not be. 
// The default query is:
//
//  UPDATE SmUser SET Password='%s' WHERE Name='%s'
//
// The first parameter is the new password, the second is the name of
// the user.
// 
// Note that the password may be encrypted, if SmAPSEx encrypted it.
// 
// This query can be a stored procedure (and should be), but the 
// replacement parameters must retain their order and meaning.
//
// Passwords will always be set using this query, never the Set 
// User Properties query above.
///////////////////////////////////////////////////////////////////////

;;Set Password=UPDATE SmUser SET Password='%s' WHERE Name='%s'

///////////////////////////////////////////////////////////////////////
// The Get Login History query does not exist in the SiteMinder Query
// scheme and therefore must be defined here if it is to be used.
//
// Login History contains an entry for each login attempt by a user.
// Typically, it will be a separate table containing two fields, the
// history entry and the user's name.
//
// The next three queries defined are also used to manipulate login
// history.
//
// There is no default query. If these queries are not defined, no 
// login history will be kept.
//
// The query has one parameter that is the user's name.
//
// The Get Login History query must return a single column with the
// login history entries. Hopefully, they're returned in order.
///////////////////////////////////////////////////////////////////////

Get Login History=SELECT smapsLoginHistory FROM LoginHistory WHERE Name='%s' ORDER BY smapsLoginHistory

///////////////////////////////////////////////////////////////////////
// The Set Login History query does not exist in the SiteMinder Query
// scheme and therefore must be defined here if it is to be used.
//
// Login History contains an entry for each login attempt by a user.
// Typically, it will be a separate table containing two fields, the
// history entry and the user's name.
//
// There is no default query. If these queries are not defined, no 
// login history will be kept.
//
// The query has two parametrers. The first is the Login History value
// and the second is the user's name.
///////////////////////////////////////////////////////////////////////

Set Login History=INSERT INTO LoginHistory (smapsLoginHistory, Name) VALUES ('%s','%s')

///////////////////////////////////////////////////////////////////////
// The Delete Login History query does not exist in the SiteMinder 
// Query scheme and therefore must be defined here if it is to be used.
//
// Login History contains an entry for each login attempt by a user.
// Typically, it will be a separate table containing two fields, the
// history entry and the user's name.
//
// There is no default query. If these queries are not defined, no 
// login history will be kept.
//
// The Delete Login History query is used by APS to clean out old 
// history values (before a specific date and time).
//
// The query has two parametrers. The first is the date and time to 
// delete before and the second is the user's name.
///////////////////////////////////////////////////////////////////////

Delete Login History=DELETE FROM LoginHistory WHERE SUBSTR(smapsLoginHistory, 1, 15) < '%s' AND Name='%s'

///////////////////////////////////////////////////////////////////////
// The Clear Login History query does not exist in the SiteMinder 
// Query scheme and therefore must be defined here if it is to be used.
//
// Login History contains an entry for each login attempt by a user.
// Typically, it will be a separate table containing two fields, the
// history entry and the user's name.
//
// There is no default query. If these queries are not defined, no 
// login history will be kept.
//
// The Clear Login History query is used by APSAdmin to clean out all
// of the login history for a specific user.
//
// The query has a single parametrer used to identify the user.
///////////////////////////////////////////////////////////////////////

Clear Login History=DELETE FROM LoginHistory WHERE Name='%s'

///////////////////////////////////////////////////////////////////////
// The Get FPS Log query does not exist in the SiteMinder Query
// scheme and therefore must be defined here if it is to be used.
//
// The FPS Log contains an entry for each FPS usage attempt by a user.
// Typically, it will be a separate table containing two fields, the
// history entry and the user's name.
//
// The next two queries defined are also used to manipulate the FPS 
// Log.
//
// There is no default query. If these queries are not defined, no 
// FPS Log will be kept.
//
// The query has one parameter that is the user's name.
//
// The Get FPS Log query must return a single column with the
// FPS Log entries. Hopefully, they're returned in order.
///////////////////////////////////////////////////////////////////////

Get FPS Log=SELECT smfpsLog FROM FPSHistory WHERE Name='%s' ORDER BY smfpsLog

///////////////////////////////////////////////////////////////////////
// The Add FPS Log query does not exist in the SiteMinder Query
// scheme and therefore must be defined here if it is to be used.
//
// The FPS Log contains an entry for each FPS usage attempt by a user.
// Typically, it will be a separate table containing two fields, the
// history entry and the user's name.
//
// There is no default query. If these queries are not defined, no 
// FPS Log will be kept.
//
// The query has two parametrers. The first is the FPS Log value
// and the second is the user's name.
///////////////////////////////////////////////////////////////////////

Add FPS Log=INSERT INTO FPSHistory (smfpsLog, Name) VALUES ('%s','%s')

///////////////////////////////////////////////////////////////////////
// The Clear FPS Log query does not exist in the SiteMinder 
// Query scheme and therefore must be defined here if it is to be used.
//
// The FPS Log contains an entry for each FPS usage attempt by a user.
// Typically, it will be a separate table containing two fields, the
// history entry and the user's name.
//
// There is no default query. If these queries are not defined, no 
// login history will be kept.
//
// The Clear FPS Log query is used by APSAdmin to clean out all
// of the FPS Log entries for a specific user.
//
// The query has a single parameter used to identify the user.
///////////////////////////////////////////////////////////////////////

Clear FPS Log=DELETE FROM FPSHistory WHERE Name='%s'

///////////////////////////////////////////////////////////////////////
// The Set Password Checksum query does not exist in the SiteMinder 
// Query scheme and therefore must be defined here if it is to be used.
//
// The Auto Force Change keyword in this file tells APS to check for
// password changes outside of APS and, if detected, force the user
// to change their password at next login. It is used to automatically
// treat external (administrative) password changes as Force Immediate
// Change situations without requiring changes to the administration
// utility.
//
// Under LDAP, APS can read back the password, calculate a checksum,
// and store it in a separate attribute. It can then check that
// value at login time to determine if the checksum changed.
//
// Under ODBC, this is not necessarily possible. Databases are 
// typically protected so that passwords cannot be read back.
//
// If Auto Force Change is to be used, the following two queries
// must be defined. These are almost always stored procedures.
//
// The query has a single parameter used to identify the user (the
// user's password has already been changed).
///////////////////////////////////////////////////////////////////////

;;Set Password Checksum=CALL SetPasswordChecksum('%s')

///////////////////////////////////////////////////////////////////////
// The Test Password Checksum query does not exist in the SiteMinder 
// Query scheme and therefore must be defined here if it is to be used.
//
// The Auto Force Change keyword in this file tells APS to check for
// password changes outside of APS and, if detected, force the user
// to change their password at next login. It is used to automatically
// treat external (administrative) password changes as Force Immediate
// Change situations without requiring changes to the administration
// utility.
//
// Under LDAP, APS can read back the password, calculate a checksum,
// and store it in a separate attribute. It can then check that
// value at login time to determine if the checksum changed.
//
// Under ODBC, this is not necessarily possible. Databases are 
// typically protected so that passwords cannot be read back.
//
// If Auto Force Change is to be used, the following two queries
// must be defined. These are almost always stored procedures.
//
// The query has a single parameter used to identify the user. The
// function should return a numeric or boolean, where non-zero 
// indicates that the checksum is invalid.
///////////////////////////////////////////////////////////////////////

;;Test Password Checksum=?=CALL TestPasswordChecksum('%s')

///////////////////////////////////////////////////////////////////////
// The Compare FPS Answer query does not exist in the SiteMinder 
// Query scheme and therefore must be defined here if it is to be used.
//
// The answers to FPS questions can be encrypted in an ODBC database.
// 
// There is no default for this query. If not defined, FPS will
// generate an error, since it won't know how to compare an
// encrypted answer (this is assuming that the encryption is not
// being performed by SmAPSEx).
//
// The query must be a stored procedure that takes three arguments
// (or, at least, three substitution parameters) and return a numeric
// or boolean (non-zero indicates that the compare is true).
//
// The first parameter is the user name. The second parameter is
// the name of the attribute, as configured to APS. The third 
// parameter is the user-entered answer (in clear text).
///////////////////////////////////////////////////////////////////////

;;Compare FPS Answer=?=CALL CompareFPSAnswer('%s', '%s', '%s')

///////////////////////////////////////////////////////////////////////
// The Add To Group query does not exist in the SiteMinder Query 
// scheme and therefore must be defined here if it is to be used.
//
// The APSAdmin API functions use this query to add users to an
// existing group (creation of groups is not supported).
//
// There is no default query for this purpose. If not specified and
// a user must be added to a group, an error will be logged and the
// update will fail.
///////////////////////////////////////////////////////////////////////

Add To Group=INSERT INTO SmUserGroup (ID,  UserID, GroupID) SELECT DISTINCT (SELECT Max(Id)+1 FROM SmUserGroup) as NewID, UserID, GroupID FROM SmUser, SmGroup WHERE (((SmGroup.Name)='%s') AND ((SmUser.Name)='%s'))

///////////////////////////////////////////////////////////////////////
// The Remove From Group query does not exist in the SiteMinder Query 
// scheme and therefore must be defined here if it is to be used.
//
// The APSAdmin API functions use this query to remove users from an
// existing group.
//
// There is no default query for this purpose. If not specified and
// a user must be removed from a group, an error will be logged and the
// update will fail.
///////////////////////////////////////////////////////////////////////

Remove From Group=DELETE FROM SmUserGroup WHERE GroupID=(SELECT GroupID FROM SmGroup WHERE Name='%s') AND UserID=(SELECT UserID FROM SmUser WHERE Name='%s')

#######################################################################
## General Section for FPS. These are generic processing instructions.
##
## FPS only supports a single directory to search, either ODBC or LDAP.
#######################################################################

[FPS]

///////////////////////////////////////////////////////////////////////
// Audit Log controls where (and if) FPS logs activity to an audit 
// file. The file is in comma-delimited format. This setting should
// contain the actual path to the file. The user under which the 
// policy server is running must have the right to create and
// write to this file. To turn off audit logging, comment out the 
// line.
//
// This setting can only appear once in this file.
//
// This setting cannot be overridden.
///////////////////////////////////////////////////////////////////////

Audit Log=c:/Program Files/CA/SiteMinder/FPS.log

///////////////////////////////////////////////////////////////////////
// The Directory setting specifies the directory that FPS will search
// for users. Only a single directory is supported for FPS.
// 
// The value of this setting can be the name or directory designator
// of the directory. FPS will query the User Directory definitions in
// SiteMinder's Policy Store and try to match up a definition with this
// value. For LDAP directories, ip addresses (with optional port), 
// network names and SiteMinder User Directory names will work. For
// ODBC directories, the DSN and the SiteMinder User Directory names 
// will work. 
///////////////////////////////////////////////////////////////////////

Directory=127.0.0.1

/////////////////////////////////////////////////////////////////////////
// The Secure Cookies setting specifies whether FPS should create secure
// cookies or not. By default, FPS does not create secure cookies. If this 
// setting is enabled, FPS will create secure cookies.
////////////////////////////////////////////////////////////////////////

;;Secure Cookies

/////////////////////////////////////////////////////////////////////////
// The HTTPOnly Cookies setting specifies whether FPS should create HTTPOnly
// cookies or not. By default, FPS does not create HTTPOnly cookies. If this 
// setting is enabled, FPS will create HTTPOnly cookies.
////////////////////////////////////////////////////////////////////////

;;HTTPOnly Cookies


/////////////////////////////////////////////////////////////////////////
// Adding support for samesite cookie. 
// Valid values are none, lax and strict
////////////////////////////////////////////////////////////////////////

;;SameSite=none
///////////////////////////////////////////////////////////////////////
// The Allowed keyword is used to restrict the users that are allowed
// to use FPS. 
//
// Multiple instances of this keyword may appear. If any instance 
// allows the current user to access FPS, then FPS can be used. 
//
// If NO Allowed keywords appear, then all users in the directory can
// use FPS. If any Allowed keyword appears, then access must be 
// explicitly granted.
//
// The value of this setting is an (override) expression that indicates
// whether a given user is allowed to access FPS.
///////////////////////////////////////////////////////////////////////

Allowed=NOT @HelpDesk

#######################################################################
## Prior to APS Version 4.0, a section called [LDAP] existing which
## defined LDAP parameters for FPS. This section is no longer needed or
## supported. If this section is found, all keywords will either be
## ignored or converted and messages logged.
#######################################################################

#######################################################################
## The FPS-IDENTIFY section defines the initial page of the FPS process 
## and parameters for the identification process
##
## Prior to APS version 4.0, this section was called IDENTIFY. If an
## IDENTIFY section is found, it is treated as FPS-IDENTIFY and a
## warning is issued.
##
## Each keyword can appear only once in this section unless otherwise
## noted.
##
## No overrides are supported in this section.
#######################################################################

[FPS-Identify]

///////////////////////////////////////////////////////////////////////
// URL                          The URL that will display the 
//                              identification form. https can be used.
//                              This setting is NOT optional.
///////////////////////////////////////////////////////////////////////

URL=<FPS_PATH>Identify.<FPS_FORM_EXTENSION>

///////////////////////////////////////////////////////////////////////
// Missing URL                  The URL to display a form if data on 
//                              the identification form is missing or 
//                              invalid. If not specified, defaults to 
//                              the URL.
///////////////////////////////////////////////////////////////////////

Missing URL=<FPS_PATH>Identify-Missing.<FPS_FORM_EXTENSION>

///////////////////////////////////////////////////////////////////////
// Not Found URL                The URL to display if, using the input 
//                              data, no user can be located. If not 
//                              specified, defaults to the URL with 
//                              "?NotFound" as the query string.
///////////////////////////////////////////////////////////////////////

Not Found URL=<FPS_PATH>Identify-NotFound.<FPS_FORM_EXTENSION>

///////////////////////////////////////////////////////////////////////
// Multiple URL                 The URL to display if, using the input
//                              data, more than one user is found. If 
//                              not specified, defaults to the URL with
//                              "?MoreData" as the query string.
///////////////////////////////////////////////////////////////////////

Multiple URL=<FPS_PATH>Identify-Multiple.<FPS_FORM_EXTENSION>

///////////////////////////////////////////////////////////////////////
// Disabled URL                 The URL to display if, using the input 
//                              data, a single user is found, but that 
//                              user is disabled. If no URL is 
//                              specified, then the "Not Found" URL 
//                              will be invoked.
///////////////////////////////////////////////////////////////////////

Disabled URL=<FPS_PATH>Identify-Disabled.<FPS_FORM_EXTENSION>

///////////////////////////////////////////////////////////////////////
// Disabled Mail                The name(s) of mail files if, using the
//                              input data, a single user is found, but
//                              that user is disabled. Multiple files
//                              can be specified, separated by 
//                              semicolons or commas. LDAP replacements
//                              may be embedded in the paths 
//                              ("{preferredLanguage}" is common).
///////////////////////////////////////////////////////////////////////

;;Disabled Mail={preferredLanguage}/UserDisabled.email;EN/Disabled.email

///////////////////////////////////////////////////////////////////////
// Required                     Lists the name of the form fields (case
//                              sensitive!) on the identify/missing 
//                              forms that are required. This is not
//                              the LDAP attribute names. Names must be
//                              separated by semicolons. If a field is 
//                              posted that is neither required nor 
//                              optional, an error will be generated.
//                              This setting is NOT optional.
///////////////////////////////////////////////////////////////////////

Required=FirstName;LastName

///////////////////////////////////////////////////////////////////////
// Optional                     Lists the name of the form fields (case
//                              sensitive!) on the identify/missing 
//                              forms that are optional. This is not
//                              the LDAP attribute names. Names must be
//                              separated by semicolons. If a field is
//                              posted that is neither required nor 
//                              optional, an error will be generated.
///////////////////////////////////////////////////////////////////////

Optional=Phone;City;State;UserID;phonenow;Mail

///////////////////////////////////////////////////////////////////////
// Lookup                       Maps form fields (case-sensitive) to 
//                              LDAP attributes (case-insensitive) for
//                              lookup. The order that they appear
//                              affects how the LDAP query is 
//                              constructed and will probably have 
//                              performance implications. Lookups must
//                              be separated by semicolons. Each lookup
//                              should be in the format
//                                  <Form Field><comparison><LDAP attribute 1>,
//                                          <LDAP attribute 2>
//                              As many LDAP attributes as required may
//                              be used. The only operations currently 
//                              supported are match ("=") and soundex 
//                              ("~="). Matches are or are not case-
//                              sensitive based on how the attribute is 
//                              defined in the LDAP directory. If 
//                              multiple LDAP attributes are defined 
//                              for a single form field, an OR is used
//                              for all attributes against the supplied
//                              field value. If no value is provided by
//                              the user for a form field, the 
//                              corresponding lookup is not used. This 
//                              setting is NOT optional.
///////////////////////////////////////////////////////////////////////

Lookup=UserID=uid;Mail=mail;FirstName=~givenname;LastName=~sn;Phone=telephoneNumber,homePhone;City=~l;State=st

///////////////////////////////////////////////////////////////////////
// Max Success Frequency        The number of days that must pass after
//                              a successful attempt before any attempt
//                              may be made again.
///////////////////////////////////////////////////////////////////////

;;Max Success Frequency=7

///////////////////////////////////////////////////////////////////////
// Too Recently Used URL        URL to send the user to if the attempt
//                              is made to soon after a succssful 
//                              attempt ("Max Success Frequency" 
//                              setting above)
///////////////////////////////////////////////////////////////////////

Too Recently Used URL=<FPS_PATH>Identify-TooRecentlyUsed.<FPS_FORM_EXTENSION>

///////////////////////////////////////////////////////////////////////
// Too Recently Used Mail       Email to send the user to if the 
//                              attempt is made to soon after a 
//                              successful attempt ("Max Success 
//                              Frequency" setting above)
///////////////////////////////////////////////////////////////////////

;;Too Recently Used Mail=EN/TooRecentlyUsed.txt

///////////////////////////////////////////////////////////////////////
// Max Attempts Frequency       The number of days that must pass after
//                              any attempt before another attempt can 
//                              be made.
///////////////////////////////////////////////////////////////////////

;;Max Attempts Frequency=1

///////////////////////////////////////////////////////////////////////
// Too Recently Attempted URL   URL to send the user to if the attempt 
//                              is made to soon after an attempt ("Max
//                              Attempts Frequency" setting above)
///////////////////////////////////////////////////////////////////////

Too Recently Attempted URL=<FPS_PATH>Identify-TooRecentlyAttempted.<FPS_FORM_EXTENSION>

///////////////////////////////////////////////////////////////////////
// Too Recently Attempted Mail  Email to send the user to if the 
//                              attempt is made to soon after an 
//                              attempt ("Max Attempts Frequency" 
//                              setting above)
///////////////////////////////////////////////////////////////////////

;;Too Recently Attempted Mail=EN/TooRecentlyAttempted.txt

///////////////////////////////////////////////////////////////////////
// Lockout Count                If the user has had this number of
//                              unsuccessful attempts (over any time
//                              period), the user will be locked out of
//                              FPS and possibly SiteMinder (if the
//                              Lockout Group DN is specified in the
//                              LDAP section). This value is ONLY reset
//                              when a successful use of FPS occurs. 
///////////////////////////////////////////////////////////////////////

Lockout Count=7

///////////////////////////////////////////////////////////////////////
// Lockout Timer                If the user is locked out due to the 
//                              Lockout Count setting above, this 
//                              setting controls how long the user is
//                              locked out. If not set or set to 0,
//                              then lockout is permanent. This value
//                              is in MINUTES and can be set to up
//                              to a year.
///////////////////////////////////////////////////////////////////////

//Lockout Timer=0

///////////////////////////////////////////////////////////////////////
// Lockout URL                  URL to send the user to if the user is
//                              locked out of FPS due to the Lockout 
//                              Count.
///////////////////////////////////////////////////////////////////////

Lockout URL=<FPS_PATH>Identify-Lockout.<FPS_FORM_EXTENSION>

///////////////////////////////////////////////////////////////////////
// Lockout Mail                 File or files to send if the user is
//                              locked out due to the lockout count.
///////////////////////////////////////////////////////////////////////

;;Lockout Mail=EN/Lockout.txt

#######################################################################
## The FPS-VERIFY section is entirely optional and is typically used to 
## validate the user by utilizing a secret question/answer type 
## algorithm.
##
## Prior to APS version 4.0, this section was called VERIFY. If a
## VERIFY section is found, it is treated as FPS-VERIFY and a
## warning is issued.
##
## Each keyword can appear only once in this section unless otherwise
## noted.
##
## Overrides are supported for some settings in this section, but,
## under normal circumstances, should not be used.
#######################################################################

[FPS-Verify]

///////////////////////////////////////////////////////////////////////
// URL          The URL that will display the verification form. https
//              can be used (and is recommended). This setting, if not 
//              supplied, will cause the entire verification process to 
//              be skipped.
///////////////////////////////////////////////////////////////////////

URL=<FPS_PATH>Verify.<FPS_FORM_EXTENSION>

///////////////////////////////////////////////////////////////////////
// Missing URL  The URL to display a form if data on the verify form is
//              missing or invalid. If not specified, defaults to the 
//              URL.
///////////////////////////////////////////////////////////////////////

Missing URL=<FPS_PATH>Verify-Missing.<FPS_FORM_EXTENSION>

///////////////////////////////////////////////////////////////////////
// Invalid URL  The URL to display if, using the input data, no user 
//              can be located. Ignored if the RetryURL is specified.
///////////////////////////////////////////////////////////////////////

Invalid URL=<FPS_PATH>Verify-Invalid.<FPS_FORM_EXTENSION>

///////////////////////////////////////////////////////////////////////
// Invalid Mail The name of a file to send as mail if, using the input
//              data, no user can be located.  Ignored if the RetryURL
//              is specified.
///////////////////////////////////////////////////////////////////////

;;Invalid Mail=EN/NoVerify.txt

///////////////////////////////////////////////////////////////////////
// Retry URL    URL to send the user to if verification fails. If this
//              setting is not specified, the Invalid URL will be used.
//              This setting should be used carefully, only if the
//              Max settings, Lockout and/or Restrict/Consume options
//              are used, since, under most circumstances, it loosens 
//              security substantially.
///////////////////////////////////////////////////////////////////////

;;Retry URL=<FPS_PATH>Verify-Invalid.<FPS_FORM_EXTENSION>

///////////////////////////////////////////////////////////////////////
// No Data URL  The URL to display if a required lookup field has no
//              data.
///////////////////////////////////////////////////////////////////////

No Data URL=<FPS_PATH>Verify-NoData.<FPS_FORM_EXTENSION>

///////////////////////////////////////////////////////////////////////
// No Data Mail Mail file(s) to send if a required lookup field has no
//              data.
///////////////////////////////////////////////////////////////////////

;;No Data Mail=EN/NoData.txt

///////////////////////////////////////////////////////////////////////
// Timeout URL  The URL to display if the user did not submit the form
//              in time or the pages are posted out of sequence (such
//              as posting after moving back to a verify form).
///////////////////////////////////////////////////////////////////////

Timeout URL=<FPS_PATH>Verify-Timeout.<FPS_FORM_EXTENSION>

///////////////////////////////////////////////////////////////////////
// Required     Lists the name of the form fields (case sensitive!) on 
//              the verify/missing forms that are required. This is not
//              the attribute names. Names must be separated by 
//              semicolons. If a field is posted that is neither 
//              required nor optional, an error will be generated. This
//              setting is NOT optional if a form is used.
///////////////////////////////////////////////////////////////////////

Required=SecretAnswer

///////////////////////////////////////////////////////////////////////
// Optional     Lists the name of the form fields (case sensitive!) on 
//              the verify/missing forms that are optional. This is not
//              the attribute names. Names must be separated by
//              semicolons. If a field is posted that is neither 
//              required nor optional, an error will be generated.
///////////////////////////////////////////////////////////////////////

;;Optional=

///////////////////////////////////////////////////////////////////////
// Lookup       Maps form fields (case-sensitive) to attributes 
//              (case-insensitive) for lookup. The order that they 
//              appear affects how the query is constructed and 
//              will probably have performance implications. Lookups 
//              must be separated by semicolons. Each lookup should be
//              in the format 
//                  <Form Field><comparison><attribute 1>,<attribute 2>
//              As many attributes as required may be used. The
//              only operations currently supported are match ("=") and
//              case-insensitive match ("=~"). If multiple attributes 
//              are defined for a single form field, an OR is used for 
//              all attributes against the supplied field value. If no 
//              value is provided by the user for a form field, the 
//              corresponding lookup is not used. This setting is NOT
//              optional if the form is used.
///////////////////////////////////////////////////////////////////////

Lookup=SecretAnswer=carlicense

///////////////////////////////////////////////////////////////////////
// Initial      Specifies the data that the verify and missing forms 
//              would like to be passed. Multiple values can be 
//              specified, separated by semicolons. Each specification
//              is in the format <Name>=<attribute>. The <Name> 
//              tells the system the name to pass the value as, the 
//              <attribute> specified where to get the data.
//              Special instructions can be placed immediately after
//              <attribute>, if required, enclosed in square 
//              brackets.
///////////////////////////////////////////////////////////////////////

;Initial=*SecretQuestion=carlicense[format=A,Pick=2,sorted]
Initial=*SecretQuestion=carlicense[format=B,Pick=1,sorted]

///////////////////////////////////////////////////////////////////////
// Timer        If specified, indicates the amount time that a user has
//              to respond to the verify request.
///////////////////////////////////////////////////////////////////////

Timer=300

///////////////////////////////////////////////////////////////////////
// ODBC Encrypt This keyword is used to indicate that a specific 
//              attribute is encrypted in the ODBC User Directory.
//              See documentation for special setup & handling.
///////////////////////////////////////////////////////////////////////

;;ODBC Encrypt=carlicense

#######################################################################
## The FPS-CHANGE section tells the system how to request a new 
## password from the user. If this section does not exist, a random 
## password will be generated.
##
## Prior to APS version 4.0, this section was called CHANGE. If a
## CHANGE section is found, it is treated as FPS-CHANGE and a
## warning is issued.
##
## Each keyword can appear only once in this section unless otherwise
## noted.
##
## Overrides are supported for settings in this section.
#######################################################################

[FPS-Change]

///////////////////////////////////////////////////////////////////////
// URL                  The URL that will display the confirmation. 
//                      https can be used (and is recommended). If this
//                      URL starts with an asterisk, FPS will use an 
//                      internal form, redirecting the user to this URL 
//                      (without the asterisk) when complete.
///////////////////////////////////////////////////////////////////////

URL=<FPS_PATH>Change.<FPS_FORM_EXTENSION>

///////////////////////////////////////////////////////////////////////
// Timeout URL          The URL to display if the user did not submit 
//                      the form in time or the pages are posted out of 
//                      sequence (such as posting after moving back to 
//                      a form).
///////////////////////////////////////////////////////////////////////

Timeout URL=<FPS_PATH>Change-Timeout.<FPS_FORM_EXTENSION>

///////////////////////////////////////////////////////////////////////
// Timeout              If specified, indicates the amount time that a 
//                      user has to respond to the form.
///////////////////////////////////////////////////////////////////////

Timeout=3000

#######################################################################
## The FPS-CONFIRM section tells the system how to notify the user when 
## the process is complete. If no Mail or URL is specified, an error 
## occurs. If mail is specified, but the user does not have a mail 
## address or mail cannot be sent, values from the No Mail section will
## be used.
## If random passwords are to be generated, this section also tells the
## system what password composition rules they should follow.
##
## Prior to APS version 4.0, this section was called CONFIRM. If a
## CONFIRM section is found, it is treated as FPS-CONFIRM and a
## warning is issued.
##
## Each keyword can appear only once in this section unless otherwise
## noted.
##
## Overrides are supported for settings in this section.
#######################################################################

[FPS-Confirm]

///////////////////////////////////////////////////////////////////////
// URL                  The URL that will display the confirmation. 
//                      https can be used (and is recommended). If this
//                      URL starts with an asterisk, FPS will use an 
//                      internal form, redirecting the user to this URL 
//                      (without the asterisk) when complete.
///////////////////////////////////////////////////////////////////////

URL=<FPS_PATH>Confirm.<FPS_FORM_EXTENSION>

///////////////////////////////////////////////////////////////////////
// Mail                 The name of a file to send as mail to confirm 
//                      the process, usually to the user. Typically, 
//                      this path includes the expression 
//                      {preferredLanguage} so that the mail will be 
//                      sent in the correct language.
///////////////////////////////////////////////////////////////////////

;;Mail={preferredLanguage}/Confirm.txt

///////////////////////////////////////////////////////////////////////
// Initial              Specifies the data that the confirm form would
//                      like to be passed. Multiple values can be 
//                      specified, separated by semicolons. Each 
//                      specification is in the format  
//                          <Name>=<attribute>. 
//                      The <Name> tells the system  the name to pass
//                      the value as, the <attribute>  specified 
//                      where to get the data.
///////////////////////////////////////////////////////////////////////

Initial=uid

///////////////////////////////////////////////////////////////////////
// Force Change         If specified, indicates that the Force Change
//                      Password flag should be set when the password 
//                      is reset.
///////////////////////////////////////////////////////////////////////

Force Change

///////////////////////////////////////////////////////////////////////
// Timeout              The length of time (in seconds) that the user
//                      has to login after confirmation before login 
//                      will be denied.
///////////////////////////////////////////////////////////////////////

Timeout=3000

//
// Composition of new, random passwords
//
// IF FPS is to generate a new, random password for the user, the
// following settings will direct how it should be generated.
// The settings are similar to the same-named settings in the
// Password Content Control (##CONTENT##) subsection of the first
// section of this file (note differences for the "Force Case" and
// "Maximum Repeat" settings).

///////////////////////////////////////////////////////////////////////
// Control desired length for new random passwords
//
// New Password Length  The length of the new, random password. This
//                      value must be between 1 and 32, inclusive. If
//                      out of range, 8 is used.
//                      This value overrides the alternate settings
//                      Minimum Length and Maxium Length, below.
//                      If all three are omitted, 8 is used.
//
// If New Password Length is not set and Minimum and/or Maximum are:
// Minimum must be at least 4 and maximum cannot be greater than 32.
// If the minimum is greater than the maximum (an unreasonable
// requirement), the maximum is increased to the minimum.
///////////////////////////////////////////////////////////////////////

New Password Length=8
;;Minimum Length=4
;;Maximum Length=32


///////////////////////////////////////////////////////////////////////
// The following two keywords control what characters are allowed and
// not allowed in the new password. Unlike most keywords in this file, 
// each of these keywords may appear as many times as required, with or 
// without overrides (the same override may appear more than once). ALL 
// applicable settings will be applied.
//
// Each value constains a list of characters. The list may or may not
// be surrounded with quotes (if the setting begins and ends with a
// quote, the quotes will be removed). This may be necessary since
// leading and trailing spaces are always ignored for settings.
//
// Duplicate characters are supressed.
//
// If allowed characters are specified, only those characters (and which
// are not listed as disallowed or precluded by the Force Case setting)
// will be used to generate random passwords.
// If NO allowed characters are specified the default list of allowed
// characters (except as specified in the disallowed list) are the
// alphanumerics:
//
//       ABCDEFGHJKLMNPRSTUVWXYZabcdefghijkmnopqrstuvwxyz23456789
//
// If NO disallowed characters are specified, then all allowed characters
// not excluded by the Force Case setting may be used in the random passwords.
//
// If a character appears in both lists, it will be not be used.
//
// To turn off this checking, comment out all values.
///////////////////////////////////////////////////////////////////////

;;Allowed Characters=abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",.';:!~@#$%^&*()_-+={}[]<>/|
;;Disallowed Characters=")("


///////////////////////////////////////////////////////////////////////
// Control whether new random passwords may include upper or lower case.
// Possible values are "lower", "upper" or "none".
// If this value is not set, the corresponding Force Case setting in the
// Password Content Control (##CONTENT##) subsection is used instead.
// If neither is set the value "none" will be used.
// CA Technologies recommend the value "none" for this keyword, since
// "upper" and "lower" reduce the total combinations of passwords, easing
// the job of programmatic attacks.
//
// If specified as "upper", randomly generated passwords will not include
// lower case characters, regardless of the AllowedCharacters setting.
// If specified as "lower", randomly generated passwords will not include
// upper case characters, regardless of the AllowedCharacters setting.
//
// Note the interaction with the settings for Minimum Upper Case and
// Minimum Lower Case.
//
// This setting only affects the Basic Latin letters A through Z. 
// APS classifies all Extended ASCII characters as "symbols". 
//
// The recommended setting is "none".
//
// This setting can be overridden.
///////////////////////////////////////////////////////////////////////

;;Force Case=none

///////////////////////////////////////////////////////////////////////
// Control desired password content for new random passwords
//
// Note that "Punctuation" includes the characters
//      "!'(),.:;?`
//
// Note that "Symbols" includes the characters
//      ~@#$%^&*()_-+={}[]<>/\|
// and any other character not classified as Punctuation or Alphanumeric.
//
// Any characters that are classified as "Punctuation" or "Symbols" are
// also considered "Other".
//
// If particular classes are not required, either comment out or set to zero
//
// It is possible to set up impossible combinations here if the maximum length
// is too short or if the AllowedCharacters setting doesn't include characters
// in a desired class (e.g. the default AllowedCharacters does not include
// Punctuation or Symbols).
///////////////////////////////////////////////////////////////////////

Minimum Letters=0
Minimum Digits=0
Minimum Alphanumeric=0

Minimum Punctuation=0
Minimum Symbols=0
Minimum Other=0

///////////////////////////////////////////////////////////////////////
// The following two settings should be used with care.
// APS considers only the Basic Latin letters A through Z for uppper and
// lower case; all Extended ASCII characters are treated as "symbols". 
///////////////////////////////////////////////////////////////////////

Minimum Upper Case=0
Minimum Lower Case=0

///////////////////////////////////////////////////////////////////////
// Control how many duplicate characters in a row are allowed.
//
//  NOTE: this functions differently than the setting for password change.
//
// Thus, if this setting is 2, the following passwords would be
// avoided:
//
//	ABCCC
//	abbbc
//
// To allow repetitions of any length, set to zero or comment out.
///////////////////////////////////////////////////////////////////////

Maximum Repeat=0



#######################################################################
## The FPS-NO MAIL section tells the system what to do if confirmation 
## should take place, at least in part, via email, but that email 
## cannot be sent.
##
## Prior to APS version 4.0, this section was called NO MAIL. If a
## NO MAIL section is found, it is treated as FPS-NO MAIL and a
## warning is issued.
##
## Each keyword can appear only once in this section unless otherwise
## noted.
##
## Overrides are supported for settings in this section.
#######################################################################

[FPS-No Mail]

///////////////////////////////////////////////////////////////////////
// URL          A URL.
///////////////////////////////////////////////////////////////////////

URL=<FPS_PATH>NoMail.<FPS_FORM_EXTENSION>

///////////////////////////////////////////////////////////////////////
// Mail         The name of a file to send as mail, usually to an 
//              Administrator.
///////////////////////////////////////////////////////////////////////

;;Mail=EN/NoMail.txt

#######################################################################
## The FPS-ERRORS section tells the system what to do if internal or 
## configuration errors are encountered during processing.
##
## Prior to APS version 4.0, this section was called ERRORS. If an
## ERRORS section is found, it is treated as FPS-ERRORS and a
## warning is issued.
##
## Each keyword can appear only once in this section unless otherwise
## noted.
##
## Overrides are supported for settings in this section.
#######################################################################

[FPS-Errors]

///////////////////////////////////////////////////////////////////////
// URL          The URL that will display the error message.
///////////////////////////////////////////////////////////////////////

URL=<FPS_PATH>Error.<FPS_FORM_EXTENSION>

///////////////////////////////////////////////////////////////////////
// Mail         The name of a file to send as mail.
///////////////////////////////////////////////////////////////////////

;;Mail=EN/Error.txt

#######################################################################
## Prior to APS version 4.0, there was a MACROS section. This section
## is no longer supported. If encountered, it will be ignored and an
## error will be logged.
#######################################################################
